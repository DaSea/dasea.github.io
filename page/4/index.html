<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Fucking Code!">
<meta property="og:type" content="website">
<meta property="og:title" content="兼容">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="兼容">
<meta property="og:description" content="Fucking Code!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="兼容">
<meta name="twitter:description" content="Fucking Code!">






  <link rel="canonical" href="http://yoursite.com/page/4/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>兼容</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">兼容</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">这是一场不停的追逐!</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/12/ndk_general_code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/12/ndk_general_code/" itemprop="url">
                  NDK常用代码示例
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-12 15:24:47" itemprop="dateCreated datePublished" datetime="2016-08-12T15:24:47+08:00">2016-08-12</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="常用的代码示例"><a href="/2016/08/12/ndk_general_code/#常用的代码示例" class="headerlink" title="常用的代码示例"></a>常用的代码示例</h1><p><strong>Talk is cheap, show me code!</strong><br><strong>主要记录数据java端与c++端的数据交互</strong></p>
<h2 id="c-端调试接口"><a href="/2016/08/12/ndk_general_code/#c-端调试接口" class="headerlink" title="c++端调试接口"></a>c++端调试接口</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// log.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __DEBUG_LOG_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __DEBUG_LOG_H__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;android/log.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TAG</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TAG <span class="meta-string">"JniDemo"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOGD_D(...)  __android_log_print(ANDROID_LOG_DEBUG,TAG, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOGD_E(...)  __android_log_print(ANDROID_LOG_ERROR,TAG, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOGD_I(...)  __android_log_print(ANDROID_LOG_INFO, TAG, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Java示例类"><a href="/2016/08/12/ndk_general_code/#Java示例类" class="headerlink" title="Java示例类"></a>Java示例类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dasea.jni;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JniData</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">boolean</span> bData;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">double</span>  dData;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span>     iData;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">byte</span>    cData;</span><br><span class="line">  <span class="keyword">public</span> String  sData;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">byte</span>    byteArr[];</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span>     intArr[];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TestSetData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    bData = <span class="keyword">true</span>;</span><br><span class="line">    dData = <span class="number">100.11</span>;</span><br><span class="line">    iData = <span class="number">333</span>;</span><br><span class="line">    cData = <span class="number">100</span>;</span><br><span class="line">    sData = <span class="string">"20150204"</span>;</span><br><span class="line">    byteArr = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; byteArr.length; i++) &#123;</span><br><span class="line">      byteArr[i] = <span class="string">'2'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    intArr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; intArr.length; i++) &#123;</span><br><span class="line">      intArr[i] = i * <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Java-Native接口类"><a href="/2016/08/12/ndk_general_code/#Java-Native接口类" class="headerlink" title="Java Native接口类"></a>Java Native接口类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dasea.jni;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JniDemo</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 测试基本数据类型</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">testBasicData</span><span class="params">(<span class="keyword">boolean</span> bData, <span class="keyword">int</span> iData, <span class="keyword">double</span> dData, String sData)</span></span>;</span><br><span class="line">  <span class="comment">// 测试Object类型</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">testObjectData</span><span class="params">(JniData data)</span></span>;</span><br><span class="line">  <span class="comment">// 测试基本类型的数组类型</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">testBasicArrData</span><span class="params">(<span class="keyword">int</span>[] data)</span></span>;</span><br><span class="line">  <span class="comment">// 测试Object的数组类型</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">testStringArrData</span><span class="params">(String[] str)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">testObjectArrData</span><span class="params">(JniData[] data)</span></span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  其他具体请看github代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="对应接口c-端的实现"><a href="/2016/08/12/ndk_general_code/#对应接口c-端的实现" class="headerlink" title="对应接口c++ 端的实现"></a>对应接口c++ 端的实现</h2><p>具体请看github代码<br><a href="https://github.com/DaSea/NdkJniDemo" target="_blank" rel="noopener">代码仓库</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/12/ndk_direct_buffer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/12/ndk_direct_buffer/" itemprop="url">
                  Java层与Jni层数据传递之Direct Buffer
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-12 15:13:45" itemprop="dateCreated datePublished" datetime="2016-08-12T15:13:45+08:00">2016-08-12</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基本"><a href="/2016/08/12/ndk_direct_buffer/#基本" class="headerlink" title="基本"></a>基本</h2><ul>
<li>共享内存的方式进行数据交换</li>
<li>比普通数组传递效率高</li>
<li>构造, 析构, 维护成本高, 所以适合长期频繁访问的大块内存区域</li>
<li>关于Direct Buffer的内存情况查考:<br><a href="http://hllvm.group.iteye.com/group/topic/27945" target="_blank" rel="noopener">text</a></li>
</ul>
<h2 id="实现"><a href="/2016/08/12/ndk_direct_buffer/#实现" class="headerlink" title="实现"></a>实现</h2><ul>
<li>java实现</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主要用于测试Direct Buffer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DirectBufferOnClickListener</span> <span class="keyword">implements</span> <span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View arg0)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == directBuffer) &#123;</span><br><span class="line">            <span class="comment">// 首先分配, 然后调用进行设置</span></span><br><span class="line">            directBuffer = ByteBuffer.allocateDirect(<span class="number">1024</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> == directBuffer) &#123;</span><br><span class="line">                Log.d(<span class="string">"JniDemo"</span>, <span class="string">"分配Direct Buffer失败!"</span>);</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            directBuffer.putChar(<span class="string">'a'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'c'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'d'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'d'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'w'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'j'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'l'</span>);</span><br><span class="line">            jniDemo.setDirectBuffer(directBuffer, directBuffer.capacity());</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 测试数据是否设置进去了</span></span><br><span class="line">            directBuffer.putChar(<span class="string">';'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'a'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'h'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'t'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'6'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'2'</span>);</span><br><span class="line">            directBuffer.putChar(<span class="string">'8'</span>);</span><br><span class="line">            jniDemo.testDirectBufferContext(<span class="number">7</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure>
<ul>
<li>C++端实现</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span>* g_directBuff = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">int</span> g_bufferLen = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// 测试Direct Buffer</span></span><br><span class="line"><span class="function">JNIEXPORT <span class="keyword">void</span> JNICALL <span class="title">Java_com_dasea_ndkjnidemo_JniDemo_setDirectBuffer</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        JNIEnv* env, jobject obj, jobject jdirectBuff, jint jcapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">void</span>* buffer = env-&gt;GetDirectBufferAddress(jdirectBuff);</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == buffer) &#123;</span><br><span class="line">        LOGD_D(<span class="string">"natilayer-&gt;setImageDirectBuffer -&gt;Invalid buffer!"</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    g_bufferLen = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(jcapacity);</span><br><span class="line">    g_directBuff = <span class="keyword">static_cast</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">char</span>*&gt;(buffer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一个put进去的字符占俩个字节, 所以%s不能直接显示, 所以需要循环显示</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; ++i) &#123;</span><br><span class="line">        LOGD_D(<span class="string">"Buffer里面的数据为: %d"</span>, g_directBuff[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    LOGD_D(<span class="string">"Buffer里面的数据为: %s, 容量为: %d"</span>, g_directBuff, g_bufferLen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">JNIEXPORT <span class="keyword">void</span> JNICALL <span class="title">Java_com_dasea_ndkjnidemo_JniDemo_testDirectBufferContext</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        JNIEnv* env, jobject obj, jint jlen)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = jlen;</span><br><span class="line">    LOGD_D(<span class="string">"有效数据长度为: %d"</span>, len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; ++i) &#123;</span><br><span class="line">        LOGD_D(<span class="string">"Buffer里面的数据为: %d"</span>, g_directBuff[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/12/ndk_dynamic_register/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/12/ndk_dynamic_register/" itemprop="url">
                  NDK动态注册方法
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-12 13:45:18" itemprop="dateCreated datePublished" datetime="2016-08-12T13:45:18+08:00">2016-08-12</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="java的方法与c-c-代码的函数对应方式"><a href="/2016/08/12/ndk_dynamic_register/#java的方法与c-c-代码的函数对应方式" class="headerlink" title="java的方法与c/c++代码的函数对应方式"></a>java的方法与c/c++代码的函数对应方式</h2><h3 id="静态方式"><a href="/2016/08/12/ndk_dynamic_register/#静态方式" class="headerlink" title="静态方式"></a>静态方式</h3><ul>
<li>通过<code>Java_[包名]_[类名]_[方法名]</code>的形式对应</li>
<li>缺点是又臭又长, 不适合管理</li>
</ul>
<h3 id="动态方式"><a href="/2016/08/12/ndk_dynamic_register/#动态方式" class="headerlink" title="动态方式"></a>动态方式</h3><ul>
<li>采用自己喜欢的函数名定义方法</li>
<li>简单, 漂亮</li>
</ul>
<h2 id="实现参考"><a href="/2016/08/12/ndk_dynamic_register/#实现参考" class="headerlink" title="实现参考"></a>实现参考</h2><h3 id="静态"><a href="/2016/08/12/ndk_dynamic_register/#静态" class="headerlink" title="静态"></a>静态</h3><p><a href="https://github.com/DaSea/NdkJniDemo/blob/master/jni/ndkjnidemo.h" target="_blank" rel="noopener">静态方法定义文件</a></p>
<h3 id="动态"><a href="/2016/08/12/ndk_dynamic_register/#动态" class="headerlink" title="动态"></a>动态</h3><ul>
<li>需要在JNI_OnLoad里面完成注册</li>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __DYNAMIC_JNIDEMO_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __DYNAMIC_JNIDEMO_H__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">jstring <span class="title">testDynamicRegister</span><span class="params">(JNIEnv* env, jobject obj)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// __DYNAMIC_JNIDEMO_H__</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>实现文件<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"dynamic_jnidemo.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"log.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 方法对应表</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">static</span> JNINativeMethod gMethods[] = &#123;</span><br><span class="line">    &#123;<span class="string">"testDynamicRegister"</span>, <span class="string">"()Ljava/lang/String;"</span>, (<span class="keyword">void</span>*)testDynamicRegister&#125;,<span class="comment">//绑定</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册方法</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">registerNatives</span><span class="params">(JNIEnv* env)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">registerNativeMethods</span><span class="params">(JNIEnv* env, <span class="keyword">const</span> <span class="keyword">char</span>* className,</span></span></span><br><span class="line"><span class="function"><span class="params">		JNINativeMethod* gMethods, <span class="keyword">int</span> numMethods)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* System.loadLibrary("lib")时调用</span></span><br><span class="line"><span class="comment">* 如果成功返回JNI版本, 失败返回-1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">JNIEXPORT jint JNICALL <span class="title">JNI_OnLoad</span><span class="params">(JavaVM* vm, <span class="keyword">void</span>* reserved)</span> </span>&#123;</span><br><span class="line">    JNIEnv* env = <span class="literal">NULL</span>;</span><br><span class="line">    jint result = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vm-&gt;GetEnv((<span class="keyword">void</span>**) &amp;env, JNI_VERSION_1_4) != JNI_OK) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == env) &#123;</span><br><span class="line">    	LOGD_D(<span class="string">"获取env失败!"</span>);</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!registerNatives(env)) &#123;<span class="comment">//注册</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LOGD_D(<span class="string">"注册方法成功"</span>);</span><br><span class="line">    <span class="comment">//成功</span></span><br><span class="line">    result = JNI_VERSION_1_4;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 为某一个类注册本地方法</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">registerNativeMethods</span><span class="params">(JNIEnv* env, <span class="keyword">const</span> <span class="keyword">char</span>* className,</span></span></span><br><span class="line"><span class="function"><span class="params">		JNINativeMethod* gMethods, <span class="keyword">int</span> numMethods)</span> </span>&#123;</span><br><span class="line">    jclass clazz;</span><br><span class="line">    clazz = env-&gt;FindClass(className);</span><br><span class="line">    <span class="keyword">if</span> (clazz == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        LOGD_D(<span class="string">"不能找到类: %s"</span>, className);</span><br><span class="line">        <span class="keyword">return</span> JNI_FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (env-&gt;RegisterNatives(clazz, gMethods, numMethods) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> JNI_FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> JNI_TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 为所有类注册本地方法</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">registerNatives</span><span class="params">(JNIEnv* env)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* kClassName = <span class="string">"com/dasea/ndkjnidemo/JniDemo"</span>;<span class="comment">//指定要注册的类</span></span><br><span class="line">    <span class="keyword">return</span> registerNativeMethods(env, kClassName, gMethods,</span><br><span class="line">            <span class="keyword">sizeof</span>(gMethods) / <span class="keyword">sizeof</span>(gMethods[<span class="number">0</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// native 方法</span></span><br><span class="line"><span class="function">jstring <span class="title">testDynamicRegister</span><span class="params">(JNIEnv* env, jobject obj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LOGD_D(<span class="string">"JAVA 调用这个方法了, 并且c++端会返回一个响应!"</span>);</span><br><span class="line">    <span class="keyword">return</span> env-&gt;NewStringUTF(<span class="string">"动态注册JNI"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/12/ndk_memory_free/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/12/ndk_memory_free/" itemprop="url">
                  NDK内存使用问题
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-12 11:50:05" itemprop="dateCreated datePublished" datetime="2016-08-12T11:50:05+08:00">2016-08-12</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="避免内存泄露"><a href="/2016/08/12/ndk_memory_free/#避免内存泄露" class="headerlink" title="避免内存泄露"></a>避免内存泄露</h1><p><strong>主要讲述了NDK编程中可能的内存泄露!</strong></p>
<h2 id="文章收录"><a href="/2016/08/12/ndk_memory_free/#文章收录" class="headerlink" title="文章收录"></a>文章收录</h2><p><a href="http://www.ibm.com/developerworks/cn/java/j-lo-jnileak/index.html?ca=drs-" target="_blank" rel="noopener">在Jni编程中避免内存泄露</a></p>
<h2 id="需要释放的内容"><a href="/2016/08/12/ndk_memory_free/#需要释放的内容" class="headerlink" title="需要释放的内容"></a>需要释放的内容</h2><p>后续整理</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/11/bat_base_if/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/11/bat_base_if/" itemprop="url">
                  批处理之if语句
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-11 15:07:51" itemprop="dateCreated datePublished" datetime="2016-08-11T15:07:51+08:00">2016-08-11</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="if语句"><a href="/2016/08/11/bat_base_if/#if语句" class="headerlink" title="if语句"></a>if语句</h2><h3 id="判断俩个字符串是否相等"><a href="/2016/08/11/bat_base_if/#判断俩个字符串是否相等" class="headerlink" title="判断俩个字符串是否相等"></a>判断俩个字符串是否相等</h3><p><code>if &quot;string1&quot; == &quot;string2&quot; command 语句</code> <strong>例子:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">:: /p 选项会要求用户从终端输入数据</span><br><span class="line">set /p var1=请输入字符串1:</span><br><span class="line">set /p var2=请输入字符串2:</span><br><span class="line">if %var1% == %var2% (</span><br><span class="line">    echo 输入的字符串相等</span><br><span class="line">) else echo 输入的字符串不相等</span><br><span class="line"></span><br><span class="line">set  var3=&quot;hello&quot;</span><br><span class="line">set  var4=&quot;hello&quot;</span><br><span class="line">if %var4% == %var3% (</span><br><span class="line">    echo 输入的字符串相等</span><br><span class="line">) else echo 输入的字符串不相等</span><br><span class="line"></span><br><span class="line">if &quot;a&quot; == &quot;A&quot; (</span><br><span class="line">    echo 输入的俩个字符相同</span><br><span class="line">) else echo 输入的俩个字符不同</span><br><span class="line"></span><br><span class="line">:: 加/i可以不区分大小写</span><br><span class="line">if /i &quot;a&quot; == &quot;A&quot; (</span><br><span class="line">    echo 输入的俩个字符相同</span><br><span class="line">) else echo 输入的俩个字符不同</span><br><span class="line"></span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<h3 id="判断俩个数值是否相等"><a href="/2016/08/11/bat_base_if/#判断俩个数值是否相等" class="headerlink" title="判断俩个数值是否相等"></a>判断俩个数值是否相等</h3><p><code>if 数值1 equ 数值2 command 语句</code></p>
<p><strong>其他关系符号:</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">中文含义</th>
<th style="text-align:left">关系符</th>
<th style="text-align:left">英文解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">等于</td>
<td style="text-align:left">equ</td>
<td style="text-align:left">equal</td>
</tr>
<tr>
<td style="text-align:left">大于</td>
<td style="text-align:left">gtr</td>
<td style="text-align:left">greater than</td>
</tr>
<tr>
<td style="text-align:left">大于或等于</td>
<td style="text-align:left">geq</td>
<td style="text-align:left">greater than or equal</td>
</tr>
<tr>
<td style="text-align:left">小于</td>
<td style="text-align:left">lss</td>
<td style="text-align:left">less than</td>
</tr>
<tr>
<td style="text-align:left">小于或等于</td>
<td style="text-align:left">leq</td>
<td style="text-align:left">less than or equal</td>
</tr>
<tr>
<td style="text-align:left">不等于</td>
<td style="text-align:left">neq</td>
<td style="text-align:left">no equal</td>
</tr>
</tbody>
</table>
<p><strong>例子:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">set /p num1=请输入数字:</span><br><span class="line">if %num1% geq 10 (</span><br><span class="line">    echo 此数大于10</span><br><span class="line">) else (</span><br><span class="line">    echo 此数小于10</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: 字符串比较而不是数字</span><br><span class="line">if &quot;12&quot; lss &quot;4&quot; (</span><br><span class="line">    echo 12竟然会小于4!</span><br><span class="line">) else (</span><br><span class="line">    echo 12当然不会小于4</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if 12 lss 4 (</span><br><span class="line">    echo 12竟然会小于4!</span><br><span class="line">) else (</span><br><span class="line">    echo 12当然不会小于4</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="判断驱动器是否存在"><a href="/2016/08/11/bat_base_if/#判断驱动器是否存在" class="headerlink" title="判断驱动器是否存在"></a>判断驱动器是否存在</h3><p><code>if [not] exist filename command</code></p>
<p><strong>例子:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if exist &quot;e:&quot; (echo e盘存在) else echo e盘不存在</span><br><span class="line"></span><br><span class="line">if exist d:\123.bat (echo 123.bat文件存在) else echo 123.bat文件不存在</span><br><span class="line"></span><br><span class="line">dir /a-d d:\123.bat &gt;nul 2&gt;nul</span><br><span class="line">if %errorlevel%==0 (echo 123.bat文件存在!) else echo 123.bat文件不存在</span><br><span class="line"></span><br><span class="line">:: 判断文件夹是否存在</span><br><span class="line">if exist test\ (echo test是文件夹) else echo test是文件</span><br><span class="line">if exist test\. (echo test是文件夹) else echo test是文件</span><br><span class="line">if exist test\nul (echo test是文件夹) else echo test是文件</span><br></pre></td></tr></table></figure>
<h3 id="判断变量是否定义"><a href="/2016/08/11/bat_base_if/#判断变量是否定义" class="headerlink" title="判断变量是否定义"></a>判断变量是否定义</h3><p><code>if defined 变量 command 语句</code> <strong>例子:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">if defined a (echo 变量a已定义) else echo 变量a没被定义</span><br><span class="line"></span><br><span class="line">echo a=</span><br><span class="line">set a=</span><br><span class="line">if defined a (echo 变量a已定义) else echo 变量a没被定义</span><br><span class="line"></span><br><span class="line">echo a=10</span><br><span class="line">set a=10</span><br><span class="line">if defined a (echo 变量a已定义) else echo 变量a没被定义</span><br><span class="line">:: 判断的时候不能写为%var%</span><br><span class="line">set var5=5</span><br><span class="line">if defined var5 (echo 变量var5已定义) else (echo 变量var5没有被定义)</span><br><span class="line">set /p var6=请输入一个数字:</span><br><span class="line">if defined %var6% (echo 变量var6已定义) else (echo 变量var6没有被定义)</span><br><span class="line"></span><br><span class="line">set var7=5</span><br><span class="line">if defined var7 (echo 变量var7已定义) else (echo 变量var7没有被定义)</span><br><span class="line">set /p var8=请输入一个数字:</span><br><span class="line">if defined var8 (echo 变量var8已定义) else (echo 变量var8没有被定义)</span><br></pre></td></tr></table></figure>
<h3 id="判断命令返回值"><a href="/2016/08/11/bat_base_if/#判断命令返回值" class="headerlink" title="判断命令返回值"></a>判断命令返回值</h3><p>if errorlevel语句特点:</p>
<ul>
<li><code>if errorlevel 0 cmmand</code>, 含义是:如果返回的错误码值大于或等于0的时,将执行cmmand操作</li>
<li><code>if %errorlevel%==0 cmmand</code>，含义是:如果返回的错误码值等于0的时候,将执行cmmand操作</li>
</ul>
<p><strong>例子:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br><span class="line">if %errorlevel% ==0 (echo neu user执行成功) else (echo net user命令执行失败)</span><br><span class="line"></span><br><span class="line">set /p input=请输入任意一条命令：</span><br><span class="line">if errorlevel 0 (echo %input% 命令执行成功) else (echo %input% 命令执行失败)</span><br><span class="line"></span><br><span class="line">:: 一般0表示成功,其他失败, 错误码范围0-255</span><br></pre></td></tr></table></figure>
<h3 id="if-not语句"><a href="/2016/08/11/bat_base_if/#if-not语句" class="headerlink" title="if not语句"></a>if not语句</h3><ul>
<li>否的意思, 失败的时候先执行</li>
<li>if not “字符串1”==”字符串2” command 语句;</li>
<li>if not数值1 equ 数值2 command 语句；</li>
<li>if not exist filename command 语句;</li>
<li>if not defined 变量 command 语句；</li>
<li>if not errorlevel 数值 command 语句。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/11/cmd_learn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/11/cmd_learn/" itemprop="url">
                  常用的一些cmd命令
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-11 14:13:56" itemprop="dateCreated datePublished" datetime="2016-08-11T14:13:56+08:00">2016-08-11</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="创建空文件的几种方式"><a href="/2016/08/11/cmd_learn/#创建空文件的几种方式" class="headerlink" title="创建空文件的几种方式"></a>创建空文件的几种方式</h2><ul>
<li>cd .&gt;a.txt</li>
<li>copy nul b.txt</li>
<li>type nul&gt;c.txt</li>
<li>echo a 2&gt;d.txt</li>
<li>fsutil file createnew e.txt 0</li>
<li>其他, 无输出, 且重定向文件即可</li>
</ul>
<h2 id="文件-文件夹相关命令"><a href="/2016/08/11/cmd_learn/#文件-文件夹相关命令" class="headerlink" title="文件,文件夹相关命令"></a>文件,文件夹相关命令</h2><ul>
<li>dir 显示目录和文件</li>
<li>cd 进入目录</li>
<li><p>attrib 显示和更改文件属性</p>
<ul>
<li>/d 必须和 /s一起使用</li>
<li>attrib h d:\123 /s /d”和”attrib h d:\123<em>.</em> /s /d</li>
<li>前一个只有d:\123以及他同名的子目录设置了隐藏;</li>
<li>后一个将所有文件和子目录设置了隐藏, 但是d:\123本身没有隐藏</li>
</ul>
</li>
<li><p>del 删除文件</p>
</li>
<li><p>copy 复制文件, 而不能复制文件夹</p>
<ul>
<li>合并文件: copy /b 文件1+文件2+文件3 合并后的文件</li>
<li>copy /b(二进制)[/a(文本)] d:\1.mp3 d::\2.mp3 e:\3.mp3 -&gt; 1.mp3和2.mp3合并为3.mp3</li>
</ul>
</li>
<li><p>xcopy 复制文件夹</p>
<ul>
<li>/s 复制非空的目录和子目录, 如果省略,只在一个目录中工作</li>
<li>/e 复制所有子目录, 包括空目录</li>
<li>/h 复制具有隐藏和系统文件属性的文件</li>
<li>/t 只复制子目录结构, 不复制文件, 要复制空目录, 加/e</li>
<li>/y 禁止提示确认要覆盖现存的目标文件</li>
<li>区别: xcopy /e d:\123 e:\kkk\ 和 xcopy /e d:\123 e:\kkk</li>
<li>俩个都是复制123目录下的所有文件(夹)到kkk, 但是前者不会询问你目标e:\kkk是目录名还是文件名</li>
</ul>
</li>
<li><p>md 创建文件夹, 创建单个文件夹</p>
<ul>
<li>对于文件名有空格的情况, 用双引号,如: md “c:\Documents and setting\123”</li>
<li>创建多个目录, 如: md abc d:\game\123 abd</li>
</ul>
</li>
</ul>
<ul>
<li><p>rd 删除空目录(目录中不能有子目录和文件)</p>
<ul>
<li>/s 除目录本身外, 还将删除指定目录下的所有子目录和文件,用于删除目录树</li>
<li>/q 安静模式, 带/s删除目录树是不要求确认</li>
</ul>
</li>
<li><p>ren 重命名文件夹</p>
<ul>
<li>ren [path]filename1 filenam2 -&gt; filenam2不能带路径</li>
</ul>
</li>
<li><p>move 移动文件夹, 重命名文件夹</p>
<ul>
<li>/y 取消确认改写一个现有目标文件的提示</li>
<li>/-y 对确认改写一个现有目标文件发出提示</li>
<li>move 命令可以跨区移动文件, 却不可以跨分区移动文件夹</li>
<li>对于跨区移动文件, 如果目标位置存在和将要移动的文件同名是, 系统会提示: “文件存在”, 命令不会执行</li>
<li>对于隐藏或系统属性的文件, 只有去除他们的属性后, move才能执行</li>
</ul>
</li>
</ul>
<h2 id="字符串查找"><a href="/2016/08/11/cmd_learn/#字符串查找" class="headerlink" title="字符串查找"></a>字符串查找</h2><ul>
<li><p>find 字符串查找</p>
<ul>
<li>find “echo” dir.bat</li>
</ul>
</li>
<li><p>findstr 字符串查找增强</p>
<ul>
<li>支持正则</li>
</ul>
</li>
</ul>
<h2 id="常用网络命令"><a href="/2016/08/11/cmd_learn/#常用网络命令" class="headerlink" title="常用网络命令"></a>常用网络命令</h2><ul>
<li><p>ping 测试ip连接</p>
<ul>
<li>-n count 发送数据包个数</li>
<li>-w timeout 超时间隔,毫秒</li>
<li>ping 1 -n 1 -w 10000 2&gt;nul 1&gt;nul : 批处理中可以用于延时10秒</li>
</ul>
</li>
<li><p>ipconfig 查看ip配置</p>
</li>
<li><p>arp 显示和修改”地址解析协议(arp)”缓存中的项目</p>
<ul>
<li>-a or -g : 显示所有项目</li>
<li>-s : 手工输入一个静态项目</li>
<li>-d : 使用本命令能够人工删除一个静态项目</li>
</ul>
</li>
<li><p>start 开启命令</p>
<ul>
<li>start “title” filename</li>
<li>start <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> : 打开百度</li>
<li>start “” “%windir%\system32\NOTEPAD.EXE” “%userprofile%\桌面\abc.txt”</li>
<li>start “” “%userprofile%\桌面\abc.doc”</li>
<li>/min 和 /max 窗口的最大化和最小化</li>
</ul>
</li>
<li><p>shutdown 关闭和重启计算机</p>
<ul>
<li>shutdown -l :该命令只能注销本机用户，对远程计算机不适用。</li>
<li>at 12:00 shutdown -s :通过-s参数，在12：00执行关闭计算机。</li>
<li>shutdown -r -t 60 :60秒后重启计算机。这里是设置重启倒计时为60秒。如果没有设置时间则默认为30秒。</li>
<li>shutdown -f -s -t 300 :通过-f参数强制计算机300秒后关闭。</li>
<li>shutdown -a :放弃系统关机</li>
</ul>
</li>
<li><p>taskkill 关闭指定进程</p>
</li>
<li>tasklist 显示本地或远程机器上的当前运行的进程列表</li>
</ul>
<h2 id="常用特殊符号"><a href="/2016/08/11/cmd_learn/#常用特殊符号" class="headerlink" title="常用特殊符号"></a>常用特殊符号</h2><h3 id="重定向"><a href="/2016/08/11/cmd_learn/#重定向" class="headerlink" title="重定向"></a>重定向</h3><ul>
<li><code>&gt;</code> 传递且覆盖</li>
<li><code>&gt;&gt;</code> 将结果追加到指定的设备</li>
</ul>
<h3 id="命令管道符"><a href="/2016/08/11/cmd_learn/#命令管道符" class="headerlink" title="命令管道符 |"></a>命令管道符 |</h3><ul>
<li>它之前的命令或语句的执行结果作为在它之后的命令或语句的处理对象</li>
<li>例1: tasklist | find /i “qq.exe” &amp;&amp; taskkill /f /im qq.exe</li>
<li>例2: echo Y | rd /s c:\abc</li>
</ul>
<h3 id="组合命令-amp-amp-amp"><a href="/2016/08/11/cmd_learn/#组合命令-amp-amp-amp" class="headerlink" title="组合命令 &amp; &amp;&amp; ||"></a>组合命令 &amp; &amp;&amp; ||</h3><ul>
<li>&amp; : 按顺序执行多条命令, 互不影响</li>
<li>&amp;&amp; : 只有前一个命令没有错, 才执行下一个</li>
<li>|| : 前一个命令执行失败后, 才执行下一个, 否则不执行下一个</li>
<li>^ : 转义字符</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1, 在cmd环境中，有些字符具备特殊功能，如 &gt;、&gt;&gt;表示重定向，| 表示管道，&amp;、&amp;&amp;、|| 表示语句连接……它</span><br><span class="line">们都有特定的功能，如果需要把它们作为字符输出的话，echo &gt;、echo | ……之类的写法就会出错——cmd解释器会</span><br><span class="line">把它们作为具有特殊功能的字符对待，而不会作为普通字符处理，这个时候，就需要对这些特殊字符做转义处理,</span><br><span class="line">在每个特殊字符前加上转义字符, 因此，要输出这些特殊字符，就需要用 echo ^&gt;、echo ^|、echo ^|^|、echo ^^……</span><br><span class="line">之类的格式来处理;</span><br><span class="line">2, 此转义字符还可以用作续行符号;</span><br><span class="line">3, @echo off</span><br><span class="line">    echo 这是^</span><br><span class="line">    一个^</span><br><span class="line">    句子</span><br><span class="line">    Pause</span><br></pre></td></tr></table></figure>
<h3 id="变量引导符"><a href="/2016/08/11/cmd_learn/#变量引导符" class="headerlink" title="变量引导符"></a>变量引导符</h3><ul>
<li>当百分号成对出现，并且其间包含非特殊字符时，一般做变量引用处理，比如：%var%、%str%;</li>
<li>百分号作为变量引用还有一种特殊形式，那就是对形式参数的引用，此时，单个百分号后面紧跟0～9这10<br>个数字，如%0、%1、%2</li>
<li>%0      表示批处理文件本身，包括完整的路径和扩展名</li>
<li>%1至%9  表示第一个参数至第九个参数</li>
<li>出现在 set /a 语句中时，表示两数相除取余数，也就是所谓的模运算，它在命令行窗口和批处理文件中的写法</li>
<li>略有差异：在命令行窗口中，只需要单个的%，在批处理文件中，需要连续两个百分号，写成%%</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">set /a num=4%%2</span><br><span class="line">echo 4除以2的余数为 %num%</span><br><span class="line"></span><br><span class="line">:: 处理当前批处理常用的</span><br><span class="line">%~0： 取文件名（名+扩展名）</span><br><span class="line">%~f0：取全路径</span><br><span class="line">%~d0：取驱动器名</span><br><span class="line">%~p0：只取路径（不包驱动器）</span><br><span class="line">%~n0：只取文件名</span><br><span class="line">%~x0：只取文件扩展名</span><br><span class="line">%~s0：取缩写全路径名</span><br><span class="line">%~a0：取文件属性</span><br><span class="line">%~t0：取文件创建时间</span><br><span class="line">%~z0：取文件大小</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<ul>
<li>转义符号：如果要显示%本身时，需要在前面用%来转义</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">echo 一个百分号：%%</span><br><span class="line">echo 两个百分号：%%%%</span><br><span class="line">echo 三个百分号：%%%%%%</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<h3 id="界定符-“”"><a href="/2016/08/11/cmd_learn/#界定符-“”" class="headerlink" title="界定符 “”"></a>界定符 “”</h3><ul>
<li>在表示带有空格或特殊符号的路径时常要用<code>&quot; &quot;</code>来将路径括起来</li>
<li>表示其中的内容是一个完整的字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /d cd &quot;d:\program files\^%*abc&quot;</span><br><span class="line">@echo off</span><br><span class="line">set &quot;var=abc 123&quot;</span><br><span class="line">echo %var%</span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line">c:\&gt;cd “Program Files”</span><br><span class="line">c:\&gt;cd progra~1</span><br><span class="line">c:\&gt;cd pro*</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/11/bat_base_for/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/11/bat_base_for/" itemprop="url">
                  批处理之for语句
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-11 09:57:40" itemprop="dateCreated datePublished" datetime="2016-08-11T09:57:40+08:00">2016-08-11</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="for基本用法"><a href="/2016/08/11/bat_base_for/#for基本用法" class="headerlink" title="for基本用法"></a>for基本用法</h2><ul>
<li>cmd窗口: for %i in (command1) do command2</li>
<li>批处理中: for %%i in (command1) do command2</li>
</ul>
<p>基本要素:</p>
<ol>
<li>or、in和do是for语句的关键字，它们三个缺一不可;</li>
<li>%%I是for语句中对形式变量的引用，就算它在do后的语句中没有参与语句的执行，也是必须出现的;</li>
<li>in之后，do之前的括号不能省略;</li>
<li>command1和command2表示字符串、变量或命令语句;</li>
<li>command1之间的元素需要用空格键, tab键, 逗号, 分号, 或等号分割;</li>
</ol>
<p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">for %%i in (bbs.bathome.cn) do (</span><br><span class="line">    echo %%i</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%i in (bbs,bathome,cn) do (</span><br><span class="line">    echo %%i</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set str=c d e f g h i j k l m n o p q r s t u v w x y z</span><br><span class="line">echo 当前硬盘的分区有：</span><br><span class="line">for %%i in (%str%) do if exist %%i: echo %%i:</span><br><span class="line"></span><br><span class="line">echo ====列出所有文件====</span><br><span class="line">for %%i in (*.*) do (</span><br><span class="line">    echo &quot;%%i&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo ====列出txt类型的文件====</span><br><span class="line">for %%i in (*.txt) do (</span><br><span class="line">    echo &quot;%%i&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo ====列出文件名只有3个字符的bat文件====</span><br><span class="line">for %%i in (???.bat) do (</span><br><span class="line">    echo &quot;%%i&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo ====循环建立三个空文件====</span><br><span class="line">for %%i in (1,2,3) do (</span><br><span class="line">    type nul&gt;test%%i.txt</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h2 id="文本解析-for-f"><a href="/2016/08/11/bat_base_for/#文本解析-for-f" class="headerlink" title="文本解析: for /f"></a>文本解析: for /f</h2><h3 id="基本用法"><a href="/2016/08/11/bat_base_for/#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rem 每次读取文本的一行数据</span><br><span class="line">for /f %%i in (test1.txt) do (</span><br><span class="line">    echo ===========</span><br><span class="line">    echo %%i</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h3 id="切分字符串-delims"><a href="/2016/08/11/bat_base_for/#切分字符串-delims" class="headerlink" title="切分字符串: delims="></a>切分字符串: delims=</h3><p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">echo -----------------------------------------</span><br><span class="line">:: 如果没有用delims, 默认会以空格或者tab键为分割符</span><br><span class="line">for /f %%i in (test1.txt) do (</span><br><span class="line">    echo ===========</span><br><span class="line">    echo %%i</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo -----------------------------------------</span><br><span class="line">:: 这里以逗号为分割符</span><br><span class="line">for /f &quot;delims=,&quot; %%i in (test1.txt) do (</span><br><span class="line">    echo ===========</span><br><span class="line">    echo %%i</span><br><span class="line">)</span><br><span class="line">echo -----------------------------------------</span><br><span class="line">:: 这里以点号和逗号为分割符, 截取前面的内容</span><br><span class="line">for /f &quot;delims=.,&quot; %%i in (test1.txt) do (</span><br><span class="line">    echo ===========</span><br><span class="line">    echo %%i</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h3 id="定点提取-tokens"><a href="/2016/08/11/bat_base_for/#定点提取-tokens" class="headerlink" title="定点提取: tokens="></a>定点提取: tokens=</h3><p>辅助delims, 用于提取具体的一段<br><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">:: 默认是以空格为分割符</span><br><span class="line">for /f &quot;tokens=1-3&quot; %%i in (test2.txt) do (</span><br><span class="line">    echo %%i</span><br><span class="line">    echo %%j</span><br><span class="line">    echo %%k</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo -----------------------------------------------</span><br><span class="line">for /f &quot;delims=, tokens=2-5&quot; %%i in (test3.txt) do (</span><br><span class="line">    echo %%i</span><br><span class="line">    echo %%j</span><br><span class="line">    echo %%k</span><br><span class="line">    echo %%l</span><br><span class="line">)</span><br><span class="line">echo -----------------------------------------------</span><br><span class="line">for /f &quot;delims=, tokens=2,3-5&quot; %%i in (test3.txt) do (</span><br><span class="line">    echo %%i</span><br><span class="line">    echo %%j</span><br><span class="line">    echo %%k</span><br><span class="line">    echo %%l</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h3 id="跳过无关内容-直奔主题-skip-n"><a href="/2016/08/11/bat_base_for/#跳过无关内容-直奔主题-skip-n" class="headerlink" title="跳过无关内容, 直奔主题: skip=n"></a>跳过无关内容, 直奔主题: skip=n</h3><p><strong>跳过n行, 从n+1行开始</strong><br><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /f &quot;skip=2&quot; %%i in (test3.txt) do echo %%i</span><br></pre></td></tr></table></figure></p>
<h3 id="忽略以指定字符打头的行-eol"><a href="/2016/08/11/bat_base_for/#忽略以指定字符打头的行-eol" class="headerlink" title="忽略以指定字符打头的行: eol="></a>忽略以指定字符打头的行: eol=</h3><p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo -----------------------------------------------</span><br><span class="line">:: 忽略以;开头的行</span><br><span class="line">for /f &quot;eol=;&quot; %%i in (test4.txt) do echo %%i</span><br><span class="line"></span><br><span class="line">echo -----------------------------------------------</span><br><span class="line">:: eol后面只能指定一个字符</span><br><span class="line">for /f &quot;eol=,&quot; %%i in (test4.txt) do echo %%i</span><br></pre></td></tr></table></figure></p>
<h3 id="使用哪种格式"><a href="/2016/08/11/bat_base_for/#使用哪种格式" class="headerlink" title="使用哪种格式?"></a>使用哪种格式?</h3><ol>
<li>for /f %%i in (文件名) do (…)</li>
<li>for /f %%i in (‘命令语句’) do (…)</li>
<li>for /f %%i in (“字符串”) do (…)</li>
<li>for /f “usebackq” %%i in (“文件名”) do (……)</li>
<li>for /f “usebackq” %%i in (<code>命令语句</code>) do (……)</li>
<li>for /f “usebackq” %%i in (‘字符串’) do (……)　</li>
</ol>
<p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -----------------------------------------------</span><br><span class="line">:: 先找到文件,在逐个输出</span><br><span class="line">for /f %%i in (&apos;dir /a-d /b test*.txt&apos;) do echo %%i</span><br></pre></td></tr></table></figure></p>
<p><strong>当路径中包含特殊字符时,需要使用usebackq, 它是一个增强型参数, 使用后, command1需要变动如下:</strong></p>
<ol>
<li>如果第一个括号里的对象是一条命令语句的话，原来的单引号’要改为后引号 `</li>
<li>如果第一个括号里的对象是字符串的话，原来的双引号”要改为单引号’</li>
<li>如果第一个括号里的对象是文件名的话，要用双引号”括起来</li>
</ol>
<p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">echo ------------------------------------------------</span><br><span class="line">:: 找不到文件</span><br><span class="line">for /f %%i in (test .txt) do echo %%i</span><br><span class="line">:: 当成字符串处理</span><br><span class="line">for /f %%i in (&quot;test .txt&quot;) do echo %%i</span><br><span class="line">:: 错误</span><br><span class="line">for /f %%i in (&apos;test .txt&apos;) do echo %%i</span><br><span class="line">:: 找不到文件</span><br><span class="line">for /f %%i in (`test .txt`) do echo %%i</span><br><span class="line"></span><br><span class="line">echo ------------------------------------------------</span><br><span class="line">:: for /f &quot;delims==&quot; %%i in (&apos;set&apos;) do echo %%i</span><br><span class="line"></span><br><span class="line">echo ------------------------------------------------</span><br><span class="line">:: 使用usebakq时候需要将(command1)的单引号改为 反引号 `(1旁边的)</span><br><span class="line">:: for /f &quot;usebackq delims==&quot; %%i in (`set`) do echo %%i</span><br><span class="line"></span><br><span class="line">echo ------------------------------------------------</span><br><span class="line">for /f &quot;usebackq&quot; %%i in (&quot;test .txt&quot;) do echo %%i</span><br><span class="line">pause</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/11/bat_base_variable/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/11/bat_base_variable/" itemprop="url">
                  批处理中常用的变量
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-11 09:18:44" itemprop="dateCreated datePublished" datetime="2016-08-11T09:18:44+08:00">2016-08-11</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="预定义的变量"><a href="/2016/08/11/bat_base_variable/#预定义的变量" class="headerlink" title="预定义的变量"></a>预定义的变量</h2><p>下面是些已经被底层定义好可以直接使用的变量：不会出现在 SET 显示的变量列表中</p>
<ul>
<li>%CD% - 扩展到当前目录字符串。</li>
<li>%DATE% - 用跟 DATE 命令同样的格式扩展到当前日期。</li>
<li>%TIME% - 用跟 TIME 命令同样的格式扩展到当前时间。</li>
<li>%RANDOM% - 扩展到 0 和 32767 之间的任意十进制数字。</li>
<li>%ERRORLEVEL% - 扩展到当前 ERRORLEVEL 数值。</li>
<li>%CMDEXTVERSION% - 扩展到当前命令处理器扩展名版本号。</li>
<li>%CMDCMDLINE% - 扩展到调用命令处理器的原始命令行。</li>
<li>%0 bat的完整路径名如”C:\Windows\system32\xxx.bat”</li>
<li>%1 bat参数1依次类推%2参数2…</li>
<li>%path% - 当前的环境变量。以分号隔开的路径列表，路径可包含空格，可以以’\’结尾, 可以以双引号包围之。</li>
</ul>
<h2 id="扩展变量"><a href="/2016/08/11/bat_base_variable/#扩展变量" class="headerlink" title="扩展变量"></a>扩展变量</h2><h3 id="与-i相关的变量（bat参数或者for循环的-i"><a href="/2016/08/11/bat_base_variable/#与-i相关的变量（bat参数或者for循环的-i" class="headerlink" title="与%i相关的变量（bat参数或者for循环的%i)"></a>与%i相关的变量（bat参数或者for循环的%i)</h3><p>假设文件为C:\Documents and Settings\jinsun\桌面\ParseSinglePkgs.bat</p>
<ul>
<li>%0 C:\Documents and Settings\jinsun\桌面\ParseSinglePkgs.bat</li>
<li>%~dp0 C:\Documents and Settings\jinsun\桌面\</li>
<li>%cd% C:\Documents and Settings\jinsun\桌面</li>
<li>%~nx0 ParseSinglePkgs.bat</li>
<li>%~n0 ParseSinglePkgs</li>
<li>%~x0 .bat</li>
</ul>
<h3 id="与-VAR-相关的变量"><a href="/2016/08/11/bat_base_variable/#与-VAR-相关的变量" class="headerlink" title="与%VAR%相关的变量"></a>与%VAR%相关的变量</h3><ul>
<li>%VAR:str1=str2% 会将VAR中的str1替换为str2(str2如果为空则可以达到删除的效果,str1前可以加_，变量%ABC:_B=%是C)</li>
<li>%VAR:~0,-2% 会提取VAR 变量的所有字符，除了最后两个</li>
<li>%VAR:~-2% 会提取VAR 变量的最后两个</li>
</ul>
<h2 id="系统变量"><a href="/2016/08/11/bat_base_variable/#系统变量" class="headerlink" title="系统变量"></a>系统变量</h2><p>他们的值由系统将其根据事先定义的条件自动赋值,我们只需要调用而已</p>
<ul>
<li>%ALLUSERSPROFILE% （allusersprofile)本地 返回”所有用户”配置文件的位置。 C:Documents and SettingsAll Users</li>
<li>%APPDATA% (appdata)本地返回默认情况下应用程序存储数据的位置。 C:Documents and SettingsAdministratorApplication Data</li>
<li>%CD% (cd)本地返回当前目录字符串。 C:Documents and SettingsAdministrator桌面</li>
<li>%CMDCMDLINE% (cmdcmdline)本地返回用来启动当前的 Cmd.exe 的准确命令行。 cmd /c “”C:Documents and SettingsAdministrator桌面a.bat” “</li>
<li>%CMDEXTVERSION%(cmdextversion)系统返回当前的”命令处理程序扩展”的版本号。2</li>
<li>%COMPUTERNAME% (computername)系统返回计算机的名称。 xxxx</li>
<li>%COMSPEC% (comspec) 系统返回命令行解释器可执行程序的准确路径。 C:WINDOWSsystem32cmd.exe</li>
<li>%DATE% 系统返回当前日期。使用与 date /t 命令相同的格式。由 Cmd.exe 生成。有关 date 命令的详细信息，请参阅 Date。</li>
<li>%ERRORLEVEL% (errorlevel) 系统返回上一条命令的错误代码。通常用非零值表示错误。</li>
<li>%HOMEDRIVE% (homedrive)系统返回连接到用户主目录的本地工作站驱动器号。基于主目录值而设置。用户主目录是在”本地用户和组”中指定的。 C:</li>
<li>%HOMEPATH% (homepath) 系统返回用户主目录的完整路径。基于主目录值而设置。用户主目录是在”本地用户和组”中指定的。 Documents and SettingsAdministrator</li>
<li>%HOMESHARE% (homeshare) 系统返回用户的共享主目录的网络路径。基于主目录值而设置。用户主目录是在”本地用户和组”中指定的。</li>
<li>%LOGONSERVER% (logonserver) 本地返回验证当前登录会话的域控制器的名称 \ xxxx</li>
<li>%NUMBER_OF_PROCESSORS% (numeer_of_processors) 系统指定安装在计算机上的处理器的数目。</li>
<li>%OS% (os)系统返回操作系统名称。Windows 2000 显示其操作系统为 Windows_NT。 Windows_NT</li>
<li>%PATH% (path)系统指定可执行文件的搜索路径</li>
<li>%PATHEXT% (pathext)系统返回操作系统认为可执行的文件扩展名的列表。 .COM .EXE .BAT .CMD .VBS .VBE .JS .JSE .WSF .WSH</li>
<li>%PROCESSOR_ARCHITECTURE% (processor_architecture) 系统返回处理器的芯片体系结构。值：x86 或 IA64 基于Itanium x86</li>
<li>%PROCESSOR_IDENTFIER% (processor_identfier)系统返回处理器说明。</li>
<li>%PROCESSOR_LEVEL% (processor_level)系统返回计算机上安装的处理器的型号。 15</li>
<li>%PROCESSOR_REVISION% (processor_revision)系统返回处理器的版本号。 4f02</li>
<li>%PROMPT% (prompt)本地 返回当前解释程序的命令提示符设置。由 Cmd.exe 生成。$P$G</li>
<li>%RANDOM% (random)系统返回 0 到 32767 之间的任意十进制数字。由 Cmd.exe 生成。 30580</li>
<li>%SYSTEMDRIVE% (systemdrive)系统返回包含 Windows server operating system 根目录（即系统根目录）的驱动器。 C:</li>
<li>%SYSTEMROOT% (systemroot)系统返回 Windows server operating system 根目录的位置。C:WINDOWS</li>
<li>%TEMP%(temp) 系统和用户返回对当前登录用户可用的应用程序所使用的默认临时目录。有些应用程序需要 TEMP，而其他应用程序则需要 TMP。</li>
<li>%TIME% 系统 返回当前时间。使用与 time /t 命令相同的格式。由 Cmd.exe 生成。有关 time 命令的详细信息，请参阅 Time。</li>
<li>%USERDOMAIN% （userdomain)本地返回包含用户帐户的域的名称。 xxxx</li>
<li>%USERNAME% (username)本地返回当前登录的用户的名称。 Administrator</li>
<li>%USERPROFILE% (userprofile)本地返回当前用户的配置文件的位置。 C:Documents and SettingsAdministrator</li>
<li>%WINDIR%(windir) 系统 返回操作系统目录的位置。 C:WINDOWS</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/11/bat_base_set/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/11/bat_base_set/" itemprop="url">
                  批处理之 set语句
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-11 09:10:54" itemprop="dateCreated datePublished" datetime="2016-08-11T09:10:54+08:00">2016-08-11</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="set语句"><a href="/2016/08/11/bat_base_set/#set语句" class="headerlink" title="set语句"></a>set语句</h2><h3 id="用set设置自定义变量"><a href="/2016/08/11/bat_base_set/#用set设置自定义变量" class="headerlink" title="用set设置自定义变量"></a>用set设置自定义变量</h3><p><code>set [vaiable=[string]]</code><br><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">:: 设置的时候等号俩边不能有空格</span><br><span class="line">set var=abcd</span><br><span class="line">echo var的值为%var%</span><br><span class="line"></span><br><span class="line">:: 清除变量,使其成为未定义状态</span><br><span class="line">set var=</span><br><span class="line">if defined var (echo var的值为%var%) else echo var没有赋值</span><br><span class="line"></span><br><span class="line">set var1=&quot;&quot;</span><br><span class="line">if defined var1 (echo var1的值为%var1%) else echo var1没有赋值</span><br><span class="line"></span><br><span class="line">:: set还可以提供一个交互界面,让用户自己输入变量的值,</span><br><span class="line">:: 然后我们在来根据这个值来做相应操作,只需要加一个&quot;/P&quot;参数就可以了!</span><br><span class="line">set /p var2=请输入变</span><br></pre></td></tr></table></figure></p>
<h3 id="用set进行字符串处理"><a href="/2016/08/11/bat_base_set/#用set进行字符串处理" class="headerlink" title="用set进行字符串处理"></a>用set进行字符串处理</h3><ol>
<li><p>字符串替换<br><code>%PATH:STR1=STR2%</code> : 将字符串变量%PATH%中的str1替换为str2<br><strong>例子:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">set a= bbs. bathome.cn</span><br><span class="line">echo 替换前为:&quot;%a%&quot;</span><br><span class="line"></span><br><span class="line">:: 删除里面的空格</span><br><span class="line">set var=%a: =%</span><br><span class="line">echo 替换后为: %var%</span><br><span class="line"></span><br><span class="line">set var1= %a:.=逗号%</span><br><span class="line">echo 替换后为: %var1%</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串截取<br><code>%a:~[m[,n]]%</code> : ~偏移, m为偏移量(从0开始), n为截取长度</p>
</li>
</ol>
<p><strong>例子:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">set a=www.github.com</span><br><span class="line">echo 源字符串为: %a%</span><br><span class="line">set var=%a:~3,5%</span><br><span class="line">echo 截取的一点: %var%</span><br><span class="line"></span><br><span class="line">:: 倒数从-1开始</span><br><span class="line">:: 从第一个到倒数第三个之前的(ww.github.)</span><br><span class="line">set var3=%a:~1,-3%</span><br><span class="line">echo %var3%</span><br><span class="line"></span><br><span class="line">:: 倒数第三个之后的(com)</span><br><span class="line">set var4=%a:~-3%</span><br><span class="line">echo %var4%</span><br><span class="line"></span><br><span class="line">:: 从倒数第三个开始取俩个字符(co)</span><br><span class="line">set var1=%a:~-3,2%</span><br><span class="line">echo %var1%</span><br><span class="line"></span><br><span class="line">::从第三个开始到结束(.github.com)</span><br><span class="line">set var2=%a:~3%</span><br><span class="line">echo %var2%</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>综合实例之求字符串长度<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">set /p str=请输入任意长度的字符串:</span><br><span class="line">echo 你输入了字符串: &quot;%str%&quot;</span><br><span class="line">call :stringlenth &quot;%str%&quot; num</span><br><span class="line">echo 字符串长度: %num%</span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line">:stringlenth</span><br><span class="line">:: echo %1</span><br><span class="line">:: 字符串计算子程序</span><br><span class="line">set substr=%~1</span><br><span class="line">:: echo %substr%</span><br><span class="line">:: 参数%1 为字符串&quot;%str%&quot;, %~1则为去掉双引号</span><br><span class="line">if not defined substr goto :eof</span><br><span class="line">set Ret=0</span><br><span class="line"></span><br><span class="line">:stringlenth_continue</span><br><span class="line">set /a Ret +=1</span><br><span class="line">set substr=%substr:~0,-1%</span><br><span class="line">echo %substr%</span><br><span class="line">if defined substr goto stringlenth_continue</span><br><span class="line">if not &quot;%2&quot;==&quot;&quot; set %2=%Ret%</span><br><span class="line">goto :eof</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="用set进行简单计算"><a href="/2016/08/11/bat_base_set/#用set进行简单计算" class="headerlink" title="用set进行简单计算"></a>用set进行简单计算</h3><p><code>set /a expression</code></p>
<ol>
<li>运算符:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">( )             分组</span><br><span class="line">!  ~  -        一元运算符</span><br><span class="line">*  /  %       算数运算符</span><br><span class="line">  -           算数运算符</span><br><span class="line">&lt;&lt;   &gt;&gt;       二进制逻辑移位</span><br><span class="line">&amp;             二进制按位“与”</span><br><span class="line">^              二进制按位“异”</span><br><span class="line">|              二进制按位“或”</span><br><span class="line">=   *=   /=   %=  =  -=           算数赋值</span><br><span class="line">&amp;=   ^=   |=   &lt;&lt;=    &gt;&gt;=          二进制运算赋值</span><br><span class="line">,                                   表达式分隔符</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>不支持浮点数</li>
<li>求余运算符 %%</li>
<li>逻辑或取余操作符, 需要用双引号括起来或者用转义字符^:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">set /a var= 1 &quot; &quot; 1  异运算</span><br><span class="line">set /a var= 1 &quot;%&quot; 1 取模运算</span><br><span class="line">set /a var= 3 &quot;&lt;&lt;&quot; 2  左移位运算，  3 的二进制为11，左移2 位为 1100，换成十进制就是12，自行验证</span><br><span class="line">set /a var= 4 &quot;&gt;&gt;&quot; 2 右移位运算，4 的二进制为100，右移动2 位为 1，结果为1</span><br><span class="line"></span><br><span class="line">@echo off</span><br><span class="line">set /p n=请输入2 的几次方:</span><br><span class="line">set /a num=1^&lt;^&lt;n</span><br><span class="line">echo %num%</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/06/global_gtags/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/06/global_gtags/" itemprop="url">
                  gtags的使用
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-08-06 00:24:04" itemprop="dateCreated datePublished" datetime="2016-08-06T00:24:04+08:00">2016-08-06</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="是啥"><a href="/2016/08/06/global_gtags/#是啥" class="headerlink" title="是啥?"></a>是啥?</h2><p>类似于ctags, 为代码添加标签, 但是对于c++, c语言, 更精确.</p>
<h2 id="使用"><a href="/2016/08/06/global_gtags/#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="生成文件列表"><a href="/2016/08/06/global_gtags/#生成文件列表" class="headerlink" title="生成文件列表"></a>生成文件列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">:: windows</span><br><span class="line">&gt; dir [path] /a-d /b /s *.cpp *.h &gt; filelist.txt</span><br><span class="line"></span><br><span class="line">:: windows</span><br><span class="line">&gt; find [path] -type f -regex &quot;.*\(\.cpp\|\.c\)$&quot; &gt; filelist.txt</span><br><span class="line">&gt; find . -type f \( -name &quot;*.java&quot; -o -name &quot;*.cpp&quot; -o -name &quot;*.h&quot; \)</span><br></pre></td></tr></table></figure>
<h3 id="生成标签"><a href="/2016/08/06/global_gtags/#生成标签" class="headerlink" title="生成标签"></a>生成标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; gtags</span><br><span class="line">:: 根据文件列表生成</span><br><span class="line">&gt; gtags -f filelist</span><br><span class="line">:: 可以使用ctags解析gtags不支持的语言</span><br><span class="line">&gt; gtags -f filelist --gtagslabel ctags</span><br><span class="line"></span><br><span class="line">:: 生成的文件的含义</span><br><span class="line">:: GTAGS：所有变量，函数定义的相关信息</span><br><span class="line">:: GRTAGS：所有变量，函数被引用的相关信息</span><br><span class="line">:: GPATH：源代码中每个文件的信息</span><br></pre></td></tr></table></figure>
<h3 id="查看文件内容"><a href="/2016/08/06/global_gtags/#查看文件内容" class="headerlink" title="查看文件内容"></a>查看文件内容</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; gtags --dump GPATH</span><br><span class="line">&gt; gtags --dump GTAGS</span><br><span class="line">&gt; gtags --dump GRTAGS</span><br></pre></td></tr></table></figure>
<h3 id="更新单个文件"><a href="/2016/08/06/global_gtags/#更新单个文件" class="headerlink" title="更新单个文件"></a>更新单个文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; gtags --single-update filename</span><br></pre></td></tr></table></figure>
<h3 id="基本用法"><a href="/2016/08/06/global_gtags/#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找函数</span></span><br><span class="line">$ global func1</span><br><span class="line"><span class="comment"># 话说支持Posix 正则, 待验证</span></span><br><span class="line">$ global <span class="string">'func[1-3]'</span> <span class="comment"># func1, func2, func3 match</span></span><br><span class="line"><span class="comment"># 引用</span></span><br><span class="line">$ global -r func</span><br><span class="line"><span class="comment"># 显示详细信息 (显示定义行的信息)</span></span><br><span class="line">$ global -x func</span><br><span class="line"><span class="comment"># 显示匹配的内容的文件的完整路径(绝对路径)</span></span><br><span class="line">$ global -a func</span><br><span class="line"><span class="comment"># 显示不在GTAGS里面定义的symbols(感觉没屌用)</span></span><br><span class="line">$ global -s X</span><br><span class="line"><span class="comment"># 使用指定的模式定位(没懂啥意思, 懂了补充)</span></span><br><span class="line">$ global -g <span class="string">'#ifdef'</span></span><br><span class="line"><span class="comment"># 定位某个文件(可以用正则, 没多大屌用)</span></span><br><span class="line">$ global -P fileB | <span class="string">'1/'</span> | <span class="string">'\.c$'</span></span><br><span class="line"><span class="comment"># 查看某一个文件的tags</span></span><br><span class="line">$ global -f path/filename</span><br><span class="line"><span class="comment"># 在当前文件夹下检索</span></span><br><span class="line">$ global -l func</span><br><span class="line"><span class="comment"># 如果你忘了symbol名字, 可以用-c进行提示</span></span><br><span class="line">$ global -c create</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">DaSea</p>
              <p class="site-description motion-element" itemprop="description">Fucking Code!</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">51</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">25</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/DaSea" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DaSea</span>

  

  
</div>


  



  <div class="powered-by">Powered by <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://theme-next.org">NexT.Gemini</a> v6.3.0</div>




        








        
      </div>
    </footer>

    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
