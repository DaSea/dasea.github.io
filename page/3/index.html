<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Fucking Code!">
<meta property="og:type" content="website">
<meta property="og:title" content="兼容">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="兼容">
<meta property="og:description" content="Fucking Code!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="兼容">
<meta name="twitter:description" content="Fucking Code!">






  <link rel="canonical" href="http://yoursite.com/page/3/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>兼容</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">兼容</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">这是一场不停的追逐!</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/10/java_merge_image/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/10/java_merge_image/" itemprop="url">
                  Java端小图平铺合并成一个大图的代码
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-02-10 17:59:12" itemprop="dateCreated datePublished" datetime="2017-02-10T17:59:12+08:00">2017-02-10</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="平铺合并"><a href="/2017/02/10/java_merge_image/#平铺合并" class="headerlink" title="平铺合并"></a>平铺合并</h2><h3 id="pc版本测试成功"><a href="/2017/02/10/java_merge_image/#pc版本测试成功" class="headerlink" title="pc版本测试成功"></a>pc版本测试成功</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将一个小图从左到右, 从上到下  连续的合并为一个大图</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> srcPng 需要合成的小图片路径及名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> outPng 合成结果的路径及名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> width  结果图片的宽</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> height 结果图片的高</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">overlapSmall</span><span class="params">(String srcPng, String outPng, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        File srcFile = <span class="keyword">new</span> File(srcPng);</span><br><span class="line">        Image bg_src = javax.imageio.ImageIO.read(srcFile);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> src_width = bg_src.getWidth(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">int</span> src_height = bg_src.getHeight(<span class="keyword">null</span>);</span><br><span class="line">        BufferedImage tag = <span class="keyword">new</span> BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);</span><br><span class="line"></span><br><span class="line">        Graphics2D g2d = tag.createGraphics();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> column = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == width%src_width)&#123;</span><br><span class="line">            column = width/src_width;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            column = width/src_width + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == height%src_height)&#123;</span><br><span class="line">            row = height/src_height;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            row = height/src_height + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_ATOP, 1.0f)); // 透明度设置</span></span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; column; ++i)&#123;</span><br><span class="line">            y = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; row; ++j) &#123;</span><br><span class="line">                g2d.drawImage(bg_src, x, y, src_width, src_height, <span class="keyword">null</span>);</span><br><span class="line">                y += src_width;</span><br><span class="line">            &#125;</span><br><span class="line">            x += src_height;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER)); // 透明度设置 结束</span></span><br><span class="line"></span><br><span class="line">        FileOutputStream out = <span class="keyword">new</span> FileOutputStream(outPng);</span><br><span class="line">        ImageIO.write(tag, <span class="string">"png"</span>, out);<span class="comment">// 写图片</span></span><br><span class="line">        out.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="android-平台测试成功"><a href="/2017/02/10/java_merge_image/#android-平台测试成功" class="headerlink" title="android 平台测试成功"></a>android 平台测试成功</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Bitmap <span class="title">overlapSmallToBitmap</span><span class="params">(Context context, <span class="keyword">int</span> srcPng, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">    Bitmap bitmap = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        InputStream is = context.getResources().openRawResource(srcPng);</span><br><span class="line">        Bitmap bg_src = BitmapFactory.decodeStream(is);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> src_width = bg_src.getWidth();</span><br><span class="line">        <span class="keyword">int</span> src_height = bg_src.getHeight();</span><br><span class="line"></span><br><span class="line">        bitmap = Bitmap.createBitmap(width, height, bg_src.getConfig());</span><br><span class="line">        Canvas canvas = <span class="keyword">new</span> Canvas(bitmap);</span><br><span class="line">        <span class="comment">// Paint paint = new Paint();</span></span><br><span class="line">        <span class="comment">// paint.setColor(Color.BLACK);</span></span><br><span class="line">        <span class="comment">// paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DARKEN));</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> column = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == width%src_width)&#123;</span><br><span class="line">            column = width/src_width;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            column = width/src_width + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == height%src_height)&#123;</span><br><span class="line">            row = height/src_height;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            row = height/src_height + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; column; ++i)&#123;</span><br><span class="line">            y = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; row; ++j) &#123;</span><br><span class="line">                canvas.drawBitmap(bg_src, x, y, <span class="keyword">null</span>);</span><br><span class="line">                y += src_width;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            x += src_height;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (bitmap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/13/sqlite3_funcion/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/13/sqlite3_funcion/" itemprop="url">
                  sqlite常用函数
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-01-13 09:56:48" itemprop="dateCreated datePublished" datetime="2017-01-13T09:56:48+08:00">2017-01-13</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="sqlite-日期-amp-时间"><a href="/2017/01/13/sqlite3_funcion/#sqlite-日期-amp-时间" class="headerlink" title="sqlite 日期&amp;时间"></a>sqlite 日期&amp;时间</h2><h3 id="日期和时期函数"><a href="/2017/01/13/sqlite3_funcion/#日期和时期函数" class="headerlink" title="日期和时期函数"></a>日期和时期函数</h3><table>
<thead>
<tr>
<th style="text-align:left">序号</th>
<th style="text-align:left">函数</th>
<th style="text-align:left">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">date(timestring, modifier, modifier)</td>
<td style="text-align:left">以YYYY-MM-DD格式返回日期</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">time(timestring, modifier, modifier)</td>
<td style="text-align:left">以HH:MM:SS格式返回时间</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">datetime(timestring, modifier, modifier)</td>
<td style="text-align:left">以YYYY-MM-DD HH:MM:SS格式返回</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">julianday(timestring, modifier, modifier)</td>
<td style="text-align:left">返回从格林尼治时间的公元前4714年11月24日正午的天数</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">strftime(format, timestring, modifier, modifier)</td>
<td style="text-align:left">根据format指定格式返回时间</td>
</tr>
</tbody>
</table>
<h3 id="timestring-时间字符串"><a href="/2017/01/13/sqlite3_funcion/#timestring-时间字符串" class="headerlink" title="timestring : 时间字符串"></a>timestring : 时间字符串</h3><table>
<thead>
<tr>
<th style="text-align:left">序号</th>
<th style="text-align:left">时间字符串</th>
<th style="text-align:left">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">YYYY-MM-DD</td>
<td style="text-align:left">2010-12-30</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">YYYY-MM-DD HH:MM</td>
<td style="text-align:left">2010-12-30 12:10</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">YYYY-MM-DD HH:MM:SS.SSSS</td>
<td style="text-align:left">2010-12-30 12:10:04.100</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">MM-DD-YYYY HH:MM</td>
<td style="text-align:left">30012-2010 12:10</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">HH:MM</td>
<td style="text-align:left">12:10</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">YYYY-MM-DDTHH:MM</td>
<td style="text-align:left">2010-12-30 12:10</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left">HH:MM:SS</td>
<td style="text-align:left">12:10:01</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:left">YYYYMMDD HHMMSS</td>
<td style="text-align:left">20101230 121001</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:left">now</td>
<td style="text-align:left">2017-1-13</td>
</tr>
</tbody>
</table>
<p>注: 可以用<code>T</code>作为时间和日期的分隔符.</p>
<h3 id="modifier-修饰符"><a href="/2017/01/13/sqlite3_funcion/#modifier-修饰符" class="headerlink" title="modifier : 修饰符"></a>modifier : 修饰符</h3><p>时间字符串后边可跟着零个或多个修饰符, 这将改变上述五个函数返回的日期和时间. 修饰符从左到右使用.<br>可在sqlite中使用的修饰符, 如下:</p>
<ol>
<li>NNN days;</li>
<li>NNN hours;</li>
<li>NNN minutes;</li>
<li>NNN.NNNN seconds;</li>
<li>NNN months;</li>
<li>NNN years;</li>
<li>start of month;</li>
<li>start of year;</li>
<li>start of day;</li>
<li>weekday N;</li>
<li>unixepoch;</li>
<li>localtime;</li>
<li>utc;</li>
</ol>
<h3 id="格式化-用于strftime"><a href="/2017/01/13/sqlite3_funcion/#格式化-用于strftime" class="headerlink" title="格式化: 用于strftime"></a>格式化: 用于strftime</h3><table>
<thead>
<tr>
<th style="text-align:left">替换</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">%d</td>
<td style="text-align:left">一月中的第几天, 01-31</td>
</tr>
<tr>
<td style="text-align:left">%f</td>
<td style="text-align:left">带小数部分的秒, ss.sss</td>
</tr>
<tr>
<td style="text-align:left">%H</td>
<td style="text-align:left">小时, 00-23</td>
</tr>
<tr>
<td style="text-align:left">%j</td>
<td style="text-align:left">一年中的第几天, 001-366</td>
</tr>
<tr>
<td style="text-align:left">%J</td>
<td style="text-align:left">儒略日数, DDDD.DDDD</td>
</tr>
<tr>
<td style="text-align:left">%m</td>
<td style="text-align:left">月, 00-12</td>
</tr>
<tr>
<td style="text-align:left">%M</td>
<td style="text-align:left">分, 00-59</td>
</tr>
<tr>
<td style="text-align:left">%s</td>
<td style="text-align:left">从1970-01-01算起的秒数</td>
</tr>
<tr>
<td style="text-align:left">%S</td>
<td style="text-align:left">秒, 00-59</td>
</tr>
<tr>
<td style="text-align:left">%w</td>
<td style="text-align:left">一周中的第几天, 0-6,(0 is sunday, 周日)</td>
</tr>
<tr>
<td style="text-align:left">%W</td>
<td style="text-align:left">一年中的第几周</td>
</tr>
<tr>
<td style="text-align:left">%Y</td>
<td style="text-align:left">年, YYYY</td>
</tr>
<tr>
<td style="text-align:left">%%</td>
<td style="text-align:left">%</td>
</tr>
</tbody>
</table>
<h3 id="实例"><a href="/2017/01/13/sqlite3_funcion/#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">date</span>(<span class="string">'now'</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">date</span>(<span class="string">'now'</span>, <span class="string">'start of month'</span>, <span class="string">'+1 month'</span>, <span class="string">'-1 day'</span>);</span><br><span class="line"><span class="keyword">select</span> datetime(<span class="number">1092941466</span>, <span class="string">'unixepoch'</span>, <span class="string">'localtime'</span>);</span><br><span class="line"><span class="keyword">select</span> julianday(<span class="string">'now'</span>) -julianday(<span class="string">'1776-07-04'</span>);</span><br><span class="line"><span class="keyword">select</span> strftime(<span class="string">'%s'</span>, <span class="string">'now'</span>) -strftime(<span class="string">'%s'</span>, <span class="string">'2004-01-01 02:34:56'</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">date</span>(<span class="string">'now'</span>, <span class="string">'start of year'</span>, <span class="string">'+9 months'</span>, <span class="string">'weekday 2'</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">time</span>(<span class="string">'12:00'</span>, <span class="string">'localtime'</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">time</span>(<span class="string">'12:00'</span>, <span class="string">'utc'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-常用函数"><a href="/2017/01/13/sqlite3_funcion/#sqlite-常用函数" class="headerlink" title="sqlite 常用函数"></a>sqlite 常用函数</h2><h3 id="函数列表"><a href="/2017/01/13/sqlite3_funcion/#函数列表" class="headerlink" title="函数列表"></a>函数列表</h3><ol>
<li>sqlite count 函数           : count 聚集函数是用来计算一个数据库表中的行数。</li>
<li>sqlite max 函数             : max 聚合函数允许我们选择某列的最大值。</li>
<li>sqlite min 函数             : min 聚合函数允许我们选择某列的最小值。</li>
<li>sqlite avg 函数             : avg 聚合函数计算某列的平均值。</li>
<li>sqlite sum 函数             : sum 聚合函数允许为一个数值列计算总和。</li>
<li>sqlite random 函数          : random 函数返回一个介于 -9223372036854775808 和 +9223372036854775807 之间的伪随机整数。</li>
<li>sqlite abs 函数             : abs 函数返回数值参数的绝对值。</li>
<li>sqlite upper 函数           : upper 函数把字符串转换为大写字母。</li>
<li>sqlite lower 函数           : lower 函数把字符串转换为小写字母。</li>
<li>sqlite length 函数         : length 函数返回字符串的长度。</li>
<li>sqlite sqlite_version 函数 : sqlite_version 函数返回 sqlite 库的版本。</li>
</ol>
<h3 id="实例-1"><a href="/2017/01/13/sqlite3_funcion/#实例-1" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(salary) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(salary) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(salary) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(salary) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> random() <span class="keyword">as</span> Random;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">abs</span>(<span class="number">5</span>), <span class="keyword">abs</span>(<span class="number">-15</span>), <span class="keyword">abs</span>(<span class="literal">NULL</span>), <span class="keyword">abs</span>(<span class="number">0</span>), <span class="keyword">abs</span>(<span class="string">"ABC"</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">upper</span>(<span class="keyword">name</span>) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">lower</span>(<span class="keyword">name</span>) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>, <span class="keyword">length</span>(<span class="keyword">name</span>) <span class="keyword">from</span> company;</span><br><span class="line"><span class="keyword">select</span> sqlite_version() <span class="keyword">as</span> <span class="string">"SQLite Version"</span>;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/12/sqlite3_advanced2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/12/sqlite3_advanced2/" itemprop="url">
                  sqlite高级-2
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-01-12 23:18:30" itemprop="dateCreated datePublished" datetime="2017-01-12T23:18:30+08:00">2017-01-12</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="sqlite-alter-命令"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-alter-命令" class="headerlink" title="sqlite alter 命令"></a>sqlite alter 命令</h2><p><code>alter table</code>命令不通过执行一个完整的转储和数据的重载来修改已有的表.<br><code>alter table</code>语句来重命名表, 还可以在已有的表中添加额外的列.<br>sqlite中, 除了重命名表和添加列外, 不支持其他操作</p>
<h3 id="语法"><a href="/2017/01/12/sqlite3_advanced2/#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 重命名表</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> datebase_name.table_name <span class="keyword">rename</span> <span class="keyword">to</span> new_table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加新列</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> datebase_name.table_name <span class="keyword">add</span> <span class="keyword">column</span> column_def...;</span><br></pre></td></tr></table></figure>
<h3 id="实例"><a href="/2017/01/12/sqlite3_advanced2/#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> company <span class="keyword">rename</span> <span class="keyword">to</span> old_company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> old_company <span class="keyword">add</span> <span class="keyword">column</span> sex <span class="built_in">char</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-truncate-table"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-truncate-table" class="headerlink" title="sqlite truncate table"></a>sqlite truncate table</h2><p>sqlite 中, 并没有truncate table命令,可以使用sqlte的delete命令删除表中已有的数据.<br>但是如果删除整个表,建议使用drop table命令.</p>
<h3 id="语法-1"><a href="/2017/01/12/sqlite3_advanced2/#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> table_name;</span><br></pre></td></tr></table></figure>
<h3 id="实例-1"><a href="/2017/01/12/sqlite3_advanced2/#实例-1" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> company;</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-视图-view"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-视图-view" class="headerlink" title="sqlite 视图(view)"></a>sqlite 视图(view)</h2><ol>
<li>视图(view)是通过相关的名称存储在数据库中的一个sqlite语句;</li>
<li>视图(view)是一个以预定义的sqlite查询形式存在的表的组合;</li>
<li>视图(view)可以包含一个表的所有行或从一个或多个表选定行;</li>
<li>视图是一种虚表, 允许用户实现以下几点:<ul>
<li>用户或用户组查找结构数据的方式更自然或直观</li>
<li>限制数据访问, 用户只能看到有限的数据, 而不是完整的表</li>
<li>汇总各种表中的数据, 用户生成报告</li>
</ul>
</li>
<li>视图是只读的, 无法进行delete, insert或update操作, 但是可以创建触发器.</li>
</ol>
<h3 id="创建视图"><a href="/2017/01/12/sqlite3_advanced2/#创建视图" class="headerlink" title="创建视图"></a>创建视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [temp | <span class="keyword">temporary</span>] <span class="keyword">view</span> view_name <span class="keyword">as</span> <span class="keyword">select</span> column1, column2...</span><br><span class="line"><span class="keyword">from</span> table_name <span class="keyword">where</span> [condition];</span><br><span class="line"><span class="comment">-- 如果使用temp 或temporary, 则将在临时数据库中创建视图.</span></span><br></pre></td></tr></table></figure>
<h3 id="实例-2"><a href="/2017/01/12/sqlite3_advanced2/#实例-2" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> company company_view <span class="keyword">as</span> <span class="keyword">select</span> <span class="keyword">id</span>, <span class="keyword">name</span>, age <span class="keyword">from</span> company;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询视图, 和查询表类似</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company_view;</span><br></pre></td></tr></table></figure>
<h3 id="删除视图"><a href="/2017/01/12/sqlite3_advanced2/#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> view_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 实例</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> company_view;</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-事务-Transaction"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-事务-Transaction" class="headerlink" title="sqlite 事务(Transaction)"></a>sqlite 事务(Transaction)</h2><ol>
<li>事务是一个对数据库执行工作单元. 事务是以逻辑顺序完成的工作单位或序列, 可以是由用户手动操作完成,<br>也可以是由某种数据库程序自动完成.</li>
<li>事务是一个或多个更改数据库的扩展. 例如, 如果您正在创建一个记录或更新或删除, 那您正在改表执行事务.</li>
<li>todo</li>
</ol>
<h3 id="事务的属性"><a href="/2017/01/12/sqlite3_advanced2/#事务的属性" class="headerlink" title="事务的属性"></a>事务的属性</h3><ol>
<li>原子性(atomicity): 确保工作单位内的所有操作都成功完成, 否则, 事务会在出现故障时终止,<br>之前的操作也会回滚到之前的状态.</li>
<li>一致性(consistency): 确保数据库在成功提交的事务上正确的改变状态.</li>
<li>隔离性(isolation)  : 使事务操作相互独立和透明.</li>
<li>持久性(durability) : 确保已提交事务的结果或效果在系统发生故障的情况下仍然存在.</li>
</ol>
<h3 id="事务控制"><a href="/2017/01/12/sqlite3_advanced2/#事务控制" class="headerlink" title="事务控制"></a>事务控制</h3><ol>
<li>begin 或 begin transaction : 开始处理事务.</li>
<li>commit : 保存修改, 或者可以使用end transaction.</li>
<li>rollback: 撤销未保存到数据库的事务, commit后就无法撤销了.</li>
</ol>
<h3 id="实例-3"><a href="/2017/01/12/sqlite3_advanced2/#实例-3" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 假设有age为25的记录</span></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> company <span class="keyword">where</span> age=<span class="number">25</span>;</span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"><span class="comment">-- 查看记录仍然存在</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> company <span class="keyword">where</span> age=<span class="number">25</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 查看已经删除, 并且rollback已经无用</span></span><br></pre></td></tr></table></figure>
<h2 id="sqlite子查询"><a href="/2017/01/12/sqlite3_advanced2/#sqlite子查询" class="headerlink" title="sqlite子查询"></a>sqlite子查询</h2><ol>
<li>子查询或内部查询或嵌套查询是在另一个sqlite查询内嵌入在where子句中的查询, 使用子查询返回的数据将被<br>用于在主查询中作为条件, 以进一步限制要检索的数据.</li>
<li>子查询与select, insert, update, delete一起使用, 伴随运算符等.</li>
<li>遵循的规则:<ul>
<li>子查询必须用括号括起来</li>
<li>子查询在select子句中只能有一列. 除非在主查询中有多列, 与子查询的所选列进行比较.</li>
<li>order by 不能用于子查询中, 虽然主查询可以使用order by; 可以使用group by, 功能与order by相同.</li>
<li>子查询返回多于一行, 只能与多值运算符一起使用, 如IN运算符.</li>
<li>between运算符不能与子查询一起使用, 但是, between可在子查询内使用.</li>
</ul>
</li>
</ol>
<h3 id="select语句中的子查询使用"><a href="/2017/01/12/sqlite3_advanced2/#select语句中的子查询使用" class="headerlink" title="select语句中的子查询使用"></a>select语句中的子查询使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name [, column_name] <span class="keyword">from</span> table1 [,table2]</span><br><span class="line"><span class="keyword">where</span> column_name <span class="keyword">operator</span> (<span class="keyword">select</span> column_name[,...] <span class="keyword">from</span> table1 [,...] [<span class="keyword">where</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- example</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> company <span class="keyword">where</span> salary&gt;<span class="number">45000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> department <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> company <span class="keyword">where</span> salary&gt;<span class="number">45000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> department);</span><br></pre></td></tr></table></figure>
<h3 id="insert语句中的子查询使用"><a href="/2017/01/12/sqlite3_advanced2/#insert语句中的子查询使用" class="headerlink" title="insert语句中的子查询使用"></a>insert语句中的子查询使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name[(column1, column2)] <span class="keyword">select</span> [* | column1[,column2]]</span><br><span class="line"><span class="keyword">from</span> table1 [, table2] [<span class="keyword">where</span> <span class="keyword">value</span> <span class="keyword">operator</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 假设company_bkp的结构与company表类似</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company_bkp <span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> company);</span><br></pre></td></tr></table></figure>
<h3 id="update语句中的子查询使用"><a href="/2017/01/12/sqlite3_advanced2/#update语句中的子查询使用" class="headerlink" title="update语句中的子查询使用"></a>update语句中的子查询使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="keyword">table</span> <span class="keyword">set</span> column_name = new_value</span><br><span class="line">[ <span class="keyword">where</span> <span class="keyword">operator</span> [ <span class="keyword">value</span> ] (<span class="keyword">select</span> column_name <span class="keyword">from</span> table_name) [ <span class="keyword">where</span>) ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> company <span class="keyword">set</span> salary = salary * <span class="number">0.50</span></span><br><span class="line"><span class="keyword">where</span> age <span class="keyword">in</span> (<span class="keyword">select</span> age <span class="keyword">from</span> company_bkp <span class="keyword">where</span> age &gt;= <span class="number">27</span> );</span><br></pre></td></tr></table></figure>
<h3 id="delete语句中的子查询使用"><a href="/2017/01/12/sqlite3_advanced2/#delete语句中的子查询使用" class="headerlink" title="delete语句中的子查询使用"></a>delete语句中的子查询使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name</span><br><span class="line">[ <span class="keyword">where</span> <span class="keyword">operator</span> [ <span class="keyword">value</span> ] (<span class="keyword">select</span> column_name <span class="keyword">from</span> table_name) [ <span class="keyword">where</span>) ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> company</span><br><span class="line"><span class="keyword">where</span> age <span class="keyword">in</span> (<span class="keyword">select</span> age <span class="keyword">from</span> company_bkp <span class="keyword">where</span> age &gt; <span class="number">27</span> );</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-autoincrement-自动递增"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-autoincrement-自动递增" class="headerlink" title="sqlite autoincrement(自动递增)"></a>sqlite autoincrement(自动递增)</h2><ol>
<li>sqlite 的 autoincrement 是一个关键字，用于表中的字段值自动递增。</li>
<li>可以在创建表时在特定的列名称上使用 autoincrement 关键字实现该字段值的自动增加。</li>
<li>关键字 AUTOINCREMENT 只能用于整型（INTEGER）字段</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_name(</span><br><span class="line">   column1 <span class="built_in">integer</span> autoincrement,</span><br><span class="line">   column2 datatype,</span><br><span class="line">   column3 datatype,</span><br><span class="line">   .....</span><br><span class="line">   columnN datatype,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 实例</span></span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">table</span> company(</span><br><span class="line">   <span class="keyword">id</span> <span class="built_in">integer</span> primary <span class="keyword">key</span>   autoincrement,</span><br><span class="line">   <span class="keyword">name</span>           <span class="built_in">text</span>      <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   age            <span class="built_in">int</span>       <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   address        <span class="built_in">char</span>(<span class="number">50</span>),</span><br><span class="line">   salary         <span class="built_in">real</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> ( <span class="string">'paul'</span>, <span class="number">32</span>, <span class="string">'california'</span>, <span class="number">20000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">'allen'</span>, <span class="number">25</span>, <span class="string">'texas'</span>, <span class="number">15000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">'teddy'</span>, <span class="number">23</span>, <span class="string">'norway'</span>, <span class="number">20000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> ( <span class="string">'mark'</span>, <span class="number">25</span>, <span class="string">'rich-mond '</span>, <span class="number">65000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> ( <span class="string">'david'</span>, <span class="number">27</span>, <span class="string">'texas'</span>, <span class="number">85000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> ( <span class="string">'kim'</span>, <span class="number">22</span>, <span class="string">'south-hall'</span>, <span class="number">45000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">name</span>,age,address,salary)</span><br><span class="line"><span class="keyword">values</span> ( <span class="string">'james'</span>, <span class="number">24</span>, <span class="string">'houston'</span>, <span class="number">10000.00</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询:.header on, .mode column</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company;</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-Explain"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-Explain" class="headerlink" title="sqlite Explain"></a>sqlite Explain</h2><p>TODO:</p>
<h2 id="sqlite-vacuum"><a href="/2017/01/12/sqlite3_advanced2/#sqlite-vacuum" class="headerlink" title="sqlite vacuum"></a>sqlite vacuum</h2><p>TODO:</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/12/sqlite3_advanced1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/12/sqlite3_advanced1/" itemprop="url">
                  sqlite高级-1
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-01-12 12:17:15" itemprop="dateCreated datePublished" datetime="2017-01-12T12:17:15+08:00">2017-01-12</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="sqlite-pragma"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-pragma" class="headerlink" title="sqlite pragma"></a>sqlite pragma</h2><p>以后追加</p>
<h2 id="sqlite-约束"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-约束" class="headerlink" title="sqlite 约束"></a>sqlite 约束</h2><h3 id="NOT-NULL-约束"><a href="/2017/01/12/sqlite3_advanced1/#NOT-NULL-约束" class="headerlink" title="NOT NULL 约束"></a>NOT NULL 约束</h3><p>默认情况下, 列可以保存为NULL值; 如果不想, 则设置为NOT NULL;NULL和没有数据是不一样的, 代表未知的数据,<br>如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">age <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">address <span class="built_in">char</span>(<span class="number">50</span>)</span><br><span class="line">salary <span class="built_in">real</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- id, name, age不接受null值;</span></span><br></pre></td></tr></table></figure>
<h3 id="default-约束"><a href="/2017/01/12/sqlite3_advanced1/#default-约束" class="headerlink" title="default 约束"></a>default 约束</h3><p>在insert时没有提供特定的值时, 提供一个默认值, 如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">age <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">address <span class="built_in">char</span>(<span class="number">50</span>)</span><br><span class="line">salary <span class="built_in">real</span> <span class="keyword">default</span> <span class="number">40000</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="unique-约束"><a href="/2017/01/12/sqlite3_advanced1/#unique-约束" class="headerlink" title="unique 约束"></a>unique 约束</h3><p>防止一个特定的列出现列个记录相同的值, 如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">unique</span></span><br><span class="line">age <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">address <span class="built_in">char</span>(<span class="number">50</span>)</span><br><span class="line">salary <span class="built_in">real</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 防止雇佣相同名称的人</span></span><br></pre></td></tr></table></figure>
<h3 id="primary-key-约束"><a href="/2017/01/12/sqlite3_advanced1/#primary-key-约束" class="headerlink" title="primary key 约束"></a>primary key 约束</h3><ol>
<li>约束唯一标识数据库表中的每个记录. 在一个表中可以有多个unique列, 但是只能有一个主键.</li>
<li>通过主键来引用表中的行. 可将主键设为其他表的外键, 来创建表的关系.</li>
<li>在<code>sqlite</code>中, 主键可以为NULL, 与其他数据库不同的地方.</li>
<li>如果一个表在任何字段上定义了一个主键, 那么该字段就不能有俩个记录相同的值;</li>
</ol>
<h3 id="check-约束"><a href="/2017/01/12/sqlite3_advanced1/#check-约束" class="headerlink" title="check 约束"></a>check 约束</h3><p>启用输入一条记录要检查值的条件. 如果为false, 则不能创建.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> company3(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">age <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">salary <span class="built_in">real</span> <span class="keyword">check</span>(salary&gt;<span class="number">0</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="删除约束"><a href="/2017/01/12/sqlite3_advanced1/#删除约束" class="headerlink" title="删除约束"></a>删除约束</h3><ol>
<li>sqlite支持alter table的有限子集.</li>
<li>在sqlite中, alter table命令允许用户重命名表, 或向现有表中添加一个新的列.</li>
<li>重命名列, 删除一列, 或从一个表中添加或删除约束列都是不可能的.</li>
</ol>
<h2 id="sqlite-joins"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-joins" class="headerlink" title="sqlite joins"></a>sqlite joins</h2><p>joins子句用于结合俩个或多个数据库中表的记录.<br>假设我们已经有表company, department, 往department中插入如下记录:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> department <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">'IT Billing'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> department <span class="keyword">values</span>(<span class="number">2</span>, <span class="string">'Engineering'</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> department <span class="keyword">values</span>(<span class="number">3</span>, <span class="string">'Finance'</span>, <span class="number">7</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="交叉连接"><a href="/2017/01/12/sqlite3_advanced1/#交叉连接" class="headerlink" title="交叉连接"></a>交叉连接</h3><p>把第一个表的每一行与第二个表的每一行进行匹配. 如果第一表有n行x列, 第二个表有m行y列, 则会产生n*m行<br>x+y列的结果表, 如下;</p>
<p><code>select * from company cross join department;</code></p>
<h3 id="内连接"><a href="/2017/01/12/sqlite3_advanced1/#内连接" class="headerlink" title="内连接"></a>内连接</h3><p>根据连接条件结合俩个表. 查询会把table1中的每一行与table2中的每一行进行比较, 如果满足连接条件,<br>就会进行合并. 内连接是默认连接, inner可以省略. 如下:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> table1 [<span class="keyword">inner</span>] <span class="keyword">join</span> table2 <span class="keyword">on</span> condition_expression</span><br><span class="line"><span class="comment">-- 为了避免冗余, 并保持较短的措辞, 可以使用using表达式</span></span><br><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> table1 [<span class="keyword">inner</span>] <span class="keyword">join</span> table2 <span class="keyword">using</span>(column1 ...)</span><br><span class="line"><span class="comment">-- 自然连接(natural join) 类似于join ... using , 只是它自会自动测试存在俩个表中每一列的值之间相等值.</span></span><br><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> table1 <span class="keyword">natural</span> <span class="keyword">join</span> table2;</span><br><span class="line"></span><br><span class="line"><span class="comment">--例子</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">inner</span> <span class="keyword">join</span> department <span class="keyword">on</span> company.id=department.id;</span><br><span class="line"><span class="comment">-- 上面产生的效果类似于如下产生的效果:</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">natural</span> <span class="keyword">join</span> department;</span><br><span class="line"><span class="comment">-- using: id 俩个表都有, 所以正确, 连接后id列合并</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">inner</span> <span class="keyword">join</span> department <span class="keyword">using</span>(<span class="keyword">id</span>);</span><br><span class="line"><span class="comment">-- error: 由于name, dept不是俩个表共有的.</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">inner</span> <span class="keyword">join</span> department <span class="keyword">using</span>(<span class="keyword">id</span>, <span class="keyword">name</span>, dept);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">inner</span> <span class="keyword">join</span> department <span class="keyword">using</span>(<span class="keyword">name</span>, dept);</span><br></pre></td></tr></table></figure></p>
<h3 id="外连接"><a href="/2017/01/12/sqlite3_advanced1/#外连接" class="headerlink" title="外连接"></a>外连接</h3><ol>
<li>外连接是内连接的扩展, sqlite支持SQL标准left, right, full三种的左外连接(left outer join).</li>
<li>基本同上</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> table1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> condition_expression</span><br><span class="line"><span class="comment">-- 为了避免冗余, 并保持较短的措辞, 可以使用using表达式</span></span><br><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> table1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> table2 <span class="keyword">using</span>(column1 ...)</span><br><span class="line"></span><br><span class="line"><span class="comment">--例子</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> department <span class="keyword">on</span> company.id=department.id;</span><br><span class="line"><span class="comment">-- using: id 俩个表都有, 所以正确, 连接后id列合并</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> department <span class="keyword">using</span>(<span class="keyword">id</span>);</span><br><span class="line"><span class="comment">-- error: 由于name, dept不是俩个表共有的.</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> department <span class="keyword">using</span>(<span class="keyword">id</span>, <span class="keyword">name</span>, dept);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> department <span class="keyword">using</span>(<span class="keyword">name</span>, dept);</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-unions子句"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-unions子句" class="headerlink" title="sqlite unions子句"></a>sqlite unions子句</h2><p>UNION子句/运算符用于合并俩个或多个select语句的结果, 不返回任何重复的行.<br>为了使用UNION, 每个select被选择的列数必须是相同的, 相同数目的列表达式, 相同的数据类型,<br>并确保他们有相同的顺序, 但他们不必有相同的长度.<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">select</span> column1 [,column2] <span class="keyword">from</span> table1 [,table2] [<span class="keyword">where</span> condition] <span class="keyword">union</span> <span class="keyword">select</span> column1 [,column2]</span><br><span class="line"><span class="keyword">from</span> table1 [,table2] [<span class="keyword">where</span> condition]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 实例</span></span><br><span class="line"><span class="keyword">select</span> emp_id, <span class="keyword">name</span>, dept <span class="keyword">from</span> company <span class="keyword">inner</span> <span class="keyword">join</span> department <span class="keyword">on</span> company.id = department.emp_id</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> emp_id, <span class="keyword">name</span>, dept <span class="keyword">from</span> company <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> department <span class="keyword">on</span> company.id = department.emp_id;</span><br></pre></td></tr></table></figure></p>
<h3 id="union-all子句"><a href="/2017/01/12/sqlite3_advanced1/#union-all子句" class="headerlink" title="union all子句"></a>union all子句</h3><p>同上, 但是会返回重复的行<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">select</span> column1 [,column2] <span class="keyword">from</span> table1 [,table2] [<span class="keyword">where</span> condition]</span><br><span class="line"><span class="keyword">union</span> all</span><br><span class="line"><span class="keyword">select</span> column1 [,column2] <span class="keyword">from</span> table1 [,table2] [<span class="keyword">where</span> condition]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 实例</span></span><br><span class="line"><span class="keyword">select</span> emp_id, <span class="keyword">name</span>, dept <span class="keyword">from</span> company <span class="keyword">inner</span> <span class="keyword">join</span> department <span class="keyword">on</span> company.id = department.emp_id</span><br><span class="line"><span class="keyword">union</span> all</span><br><span class="line"><span class="keyword">select</span> emp_id, <span class="keyword">name</span>, dept <span class="keyword">from</span> company <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> department <span class="keyword">on</span> company.id = department.emp_id;</span><br></pre></td></tr></table></figure></p>
<h2 id="sqlite-null-值"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-null-值" class="headerlink" title="sqlite null 值"></a>sqlite null 值</h2><p>sqlite的null是用来表示一个缺失值的项. 表中的一个NULL值是在字段中显示为空白的一个值.<br>带有null值的字段是一个不带有值的字段. null值和零值或包含空格的字段是不同的.</p>
<h3 id="语法-实例"><a href="/2017/01/12/sqlite3_advanced1/#语法-实例" class="headerlink" title="语法, 实例"></a>语法, 实例</h3><p>参照创建表</p>
<h3 id="is-not-null运算符"><a href="/2017/01/12/sqlite3_advanced1/#is-not-null运算符" class="headerlink" title="is not null运算符"></a>is not null运算符</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> salary <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-别名"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-别名" class="headerlink" title="sqlite 别名"></a>sqlite 别名</h2><p>可以暂时把表或列重命名为另一个名字, 就是别名. 使用表别名是指在一个特定的sqlite语句中重命名表.<br>重命名是临时的改变, 数据库中实机的表是不会改变的. 列别名同表别名.</p>
<h3 id="语法"><a href="/2017/01/12/sqlite3_advanced1/#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表别名</span></span><br><span class="line"><span class="keyword">select</span> column1, column2, ... <span class="keyword">from</span> table_name <span class="keyword">as</span> alias_name <span class="keyword">where</span> [condition]</span><br><span class="line"><span class="comment">-- 列别名</span></span><br><span class="line"><span class="keyword">select</span> column1 <span class="keyword">as</span> alias_name <span class="keyword">from</span> table_name <span class="keyword">where</span> [condition]</span><br></pre></td></tr></table></figure>
<h3 id="实例"><a href="/2017/01/12/sqlite3_advanced1/#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表别名</span></span><br><span class="line"><span class="keyword">select</span> c.id, c.name, c.age, d.dept <span class="keyword">from</span> company <span class="keyword">as</span> c, department <span class="keyword">as</span> d <span class="keyword">where</span> c.id=d.emp_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列别名</span></span><br><span class="line"><span class="keyword">select</span> c.id <span class="keyword">as</span> company_id, c.name <span class="keyword">as</span> company_name, c.age, d.dept <span class="keyword">from</span> company <span class="keyword">as</span> c,</span><br><span class="line">department <span class="keyword">as</span> d <span class="keyword">where</span> c.id = d.emp_id;</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-触发器-trigger"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-触发器-trigger" class="headerlink" title="sqlite 触发器(trigger)"></a>sqlite 触发器(trigger)</h2><p>触发器是数据库的回调函数, 它会在指定的数据库事件发生时自动执行或调用. 以下是相关要点:</p>
<ol>
<li>指定在特定的数据库表发生delete, insert, 或update时触发, 或在一个或多个指定表的列发生更新是触发;</li>
<li>只支持for each row触发器, 没有for each statement触发器, 因此for each row是可选的.</li>
<li>when 子句与触发器动作可能访问使用表单new.column-name 和 old.column-name的引用插入,<br>删除或更新的行元素, 其中column-name是从与触发器关联的表的列的名称.</li>
<li>如果提供when子句, 则只针对when子句为真的指定行执行sql语句. 否则, 为所有行执行.</li>
<li>defore 或 after 关键字决定何时执行触发器动作. 决定是在关联行的插入, 修改或删除之前或之后执行.</li>
<li>当触发器关联的表删除时, 自动删除触发器.</li>
<li>要修改的表必须存在与同一数据库中, 作为触发器被附加的表或视图, 且必须只使用tabname,<br>而不是database.tablename.</li>
<li>一个特殊的sql函数raise() 用于触发器程序内抛出异常.</li>
</ol>
<h3 id="语法-1"><a href="/2017/01/12/sqlite3_advanced1/#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建触发器</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> trigger_name [<span class="keyword">before</span> | <span class="keyword">after</span>] event_name <span class="keyword">on</span> table_name</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">-- trigger 逻辑代码</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> trigger_name [<span class="keyword">before</span> | <span class="keyword">after</span> ] <span class="keyword">update</span> <span class="keyword">of</span> column_name <span class="keyword">on</span> table_name</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">-- 触发器逻辑代码</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h3 id="实例-1"><a href="/2017/01/12/sqlite3_advanced1/#实例-1" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 为company表的每一个记录保持审计试验</span></span><br><span class="line"><span class="comment">-- 创建一个audit表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">audit</span>(emp_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>, entry_date <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建一个触发器</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> audit_log <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> company</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">audit</span>(emp_id, entry_date) <span class="keyword">values</span>(new.id, datetime(<span class="string">'now'</span>));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 往company中插入一条记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company(<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">11</span>, <span class="string">'feng'</span>, <span class="number">28</span>, <span class="number">6722</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 执行上步后, 也会在audit中插入一个记录</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">audit</span>;</span><br></pre></td></tr></table></figure>
<h3 id="列出触发器和删除触发器"><a href="/2017/01/12/sqlite3_advanced1/#列出触发器和删除触发器" class="headerlink" title="列出触发器和删除触发器"></a>列出触发器和删除触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列出</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> sqlite_master <span class="keyword">where</span> <span class="keyword">type</span>=<span class="string">'trigger'</span>;</span><br><span class="line"><span class="comment">-- 删除</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> trigger_name</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-索引-index"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-索引-index" class="headerlink" title="sqlite 索引(index)"></a>sqlite 索引(index)</h2><ol>
<li>索引是一种特殊的查找表, 数据库搜索引擎用来加快数据检索;</li>
<li>索引有助于加快select查询和where子句, 但是会减慢update和insert语句时的数据输入;</li>
<li>索引可以创建和删除, 不会影响源数据;</li>
<li>使用create index创建索引, 允许命名索引, 指定表及要索引的一列或多列, 并指示索引是升序还是降序;</li>
<li>索引也可以是唯一的, 与unique约束类似, 在列上或列组合上防止重复条目;</li>
</ol>
<h3 id="创建索引-create-index"><a href="/2017/01/12/sqlite3_advanced1/#创建索引-create-index" class="headerlink" title="创建索引(create index)"></a>创建索引(create index)</h3><ol>
<li>如果查询一般使用一个列, 则使用单列索引;</li>
<li>如果使用多列, 则使用组合索引;</li>
</ol>
<h4 id="单列索引"><a href="/2017/01/12/sqlite3_advanced1/#单列索引" class="headerlink" title="单列索引"></a>单列索引</h4><p>只基于表的一个列上创建的索引.<br><code>create index index_name on table_name(column_name);</code></p>
<h4 id="唯一索引"><a href="/2017/01/12/sqlite3_advanced1/#唯一索引" class="headerlink" title="唯一索引"></a>唯一索引</h4><p>唯一索引不允许任何重复的值插入到表中<br><code>create unique index index_name on table_name(column_name);</code></p>
<h4 id="组合索引"><a href="/2017/01/12/sqlite3_advanced1/#组合索引" class="headerlink" title="组合索引"></a>组合索引</h4><p>基于表的俩个或多个列上创建的索引<br><code>create index index_name on table_name(column1, column2);</code></p>
<h4 id="隐式索引"><a href="/2017/01/12/sqlite3_advanced1/#隐式索引" class="headerlink" title="隐式索引"></a>隐式索引</h4><p>创建表时, 由数据库服务器自动创建的索引. 索引自动创建为主键约束和唯一约束.</p>
<h3 id="删除索引"><a href="/2017/01/12/sqlite3_advanced1/#删除索引" class="headerlink" title="删除索引"></a>删除索引</h3><p><code>drop index index_name</code></p>
<h3 id="以下情况避免使用索引"><a href="/2017/01/12/sqlite3_advanced1/#以下情况避免使用索引" class="headerlink" title="以下情况避免使用索引"></a>以下情况避免使用索引</h3><ol>
<li>不应该使用在较小的表上;</li>
<li>不应该使用在有频繁的大批量的更新或插入操作的表上;</li>
<li>不应该使用在含有大量的null值的列上;</li>
<li>不应该使用在频繁操作的列上;</li>
</ol>
<h3 id="实例-2"><a href="/2017/01/12/sqlite3_advanced1/#实例-2" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> salary_index <span class="keyword">on</span> company(salary);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看所有索引</span></span><br><span class="line">.indices company</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出数据所有的索引</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sqlite_master <span class="keyword">where</span> <span class="keyword">type</span>=<span class="string">'index'</span>;</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-indexed-by"><a href="/2017/01/12/sqlite3_advanced1/#sqlite-indexed-by" class="headerlink" title="sqlite indexed by"></a>sqlite indexed by</h2><p>“indexed by index_name” 子句规定必须需要命名的索引来查找前面表中值. 如果不存在或不能用于查询,<br>语句失败. “not indexed” 子句规定当访问前面的表时, 没有使用索引. 然而, 即使指定了”not indexed”,<br>integer primary key仍然可以用于查找条目.</p>
<h3 id="语法-2"><a href="/2017/01/12/sqlite3_advanced1/#语法-2" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>|<span class="keyword">delete</span>|<span class="keyword">update</span> column1, column2 indexed <span class="keyword">by</span> (index_name)</span><br><span class="line">table_name <span class="keyword">where</span> (condition);</span><br></pre></td></tr></table></figure>
<h3 id="实例-3"><a href="/2017/01/12/sqlite3_advanced1/#实例-3" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 假设有表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> age_index <span class="keyword">on</span> company(age);</span><br><span class="line"><span class="comment">-- 使用</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company indexed <span class="keyword">by</span> age_index <span class="keyword">where</span> age&gt;<span class="number">30</span>;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/06/sqlite3_base/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/06/sqlite3_base/" itemprop="url">
                  sqlite基础
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-01-06 23:36:39" itemprop="dateCreated datePublished" datetime="2017-01-06T23:36:39+08:00">2017-01-06</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="sqlite-命令"><a href="/2017/01/06/sqlite3_base/#sqlite-命令" class="headerlink" title="sqlite 命令"></a>sqlite 命令</h2><h3 id="DDL-数据定义语言"><a href="/2017/01/06/sqlite3_base/#DDL-数据定义语言" class="headerlink" title="DDL 数据定义语言"></a>DDL 数据定义语言</h3><ol>
<li>create 创建一个表,一个表的视图, 或数据库中的其他对象</li>
<li>alter  修改数据库中的某个已有的数据库对象, 比如一个表</li>
<li>drop   删除表或视图, 或其他对象</li>
</ol>
<h3 id="DML-数据操作语言"><a href="/2017/01/06/sqlite3_base/#DML-数据操作语言" class="headerlink" title="DML 数据操作语言"></a>DML 数据操作语言</h3><ol>
<li>insert 创建一条记录</li>
<li>update 修改记录</li>
<li>delete 删除记录</li>
</ol>
<h3 id="DQL-数据查询语言"><a href="/2017/01/06/sqlite3_base/#DQL-数据查询语言" class="headerlink" title="DQL 数据查询语言"></a>DQL 数据查询语言</h3><p>select 检索记录</p>
<h3 id="点命令"><a href="/2017/01/06/sqlite3_base/#点命令" class="headerlink" title="点命令"></a>点命令</h3><ol>
<li>.help 查看帮助</li>
<li>.backup 可以备份</li>
<li>.tables 查看数据库里面的表</li>
<li>.schema tab_name : 查看表结构</li>
<li>…其他</li>
</ol>
<h2 id="sqlite语法"><a href="/2017/01/06/sqlite3_base/#sqlite语法" class="headerlink" title="sqlite语法"></a>sqlite语法</h2><ol>
<li>不区分大小写, 但有些命令大小写敏感,如GLOB 和glob;</li>
<li>注释: – 注释 或 /<em> 注释 </em>/</li>
</ol>
<h2 id="sqlite-数据类型"><a href="/2017/01/06/sqlite3_base/#sqlite-数据类型" class="headerlink" title="sqlite 数据类型"></a>sqlite 数据类型</h2><h3 id="存储类型"><a href="/2017/01/06/sqlite3_base/#存储类型" class="headerlink" title="存储类型"></a>存储类型</h3><ol>
<li>NULL    : NULL值;</li>
<li>integer : 带符号的整数, 根据大小存储在1,2,3,4,6或8字节中;</li>
<li>real    : 8字节的IEEE浮点数字;</li>
<li>text    : 文本字符串;</li>
<li>blob    : 根据输入存储;</li>
</ol>
<h3 id="亲和类型"><a href="/2017/01/06/sqlite3_base/#亲和类型" class="headerlink" title="亲和类型"></a>亲和类型</h3><p>当数据插入时, 该字段的数据会优先采用亲缘类型作为该值的存储方式</p>
<ol>
<li>text    : 数值型数据在被插入前, 需要先被转换为文本格式, 之后再插入到目标字段中;</li>
<li>numeric : 当文本数据被插入到到此字段时, 如果转换操作不会导致数据信息丢失以及完全可逆, 则转换为real<pre><code>或integer类型的数据, 如果失败,则以text存储;如&apos;3000.00&apos;的浮点数, 也会存储未real或integer;
</code></pre></li>
<li>integer : 同上, 差别在于转换操作;</li>
<li>real    : 同numeric, 差别在于不会转换’3000.00’的形式;</li>
<li>none    : 不做转换;</li>
</ol>
<h3 id="亲和类型及类型名称"><a href="/2017/01/06/sqlite3_base/#亲和类型及类型名称" class="headerlink" title="亲和类型及类型名称"></a>亲和类型及类型名称</h3><ol>
<li>int,integer,tinyint,smallint,mediumint,bigint,unsigned big int, int2, int8 : integer;</li>
<li>character(20), varchar(255), varying, character(255), nchar(55), native character(70),<br>nvarchar(100), text, clob: text;</li>
<li>blob, no datatype specified: none;</li>
<li>real, double, double precision, float: real;</li>
<li>numeric, decimal(10,5), boolean(0, 1) date, datetime: numeric;</li>
</ol>
<h2 id="sqlite-使用"><a href="/2017/01/06/sqlite3_base/#sqlite-使用" class="headerlink" title="sqlite 使用"></a>sqlite 使用</h2><h3 id="创建表"><a href="/2017/01/06/sqlite3_base/#创建表" class="headerlink" title="创建表"></a>创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 例子</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> company(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">age <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">address <span class="built_in">char</span>(<span class="number">50</span>),</span><br><span class="line">salary <span class="built_in">real</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="删除表"><a href="/2017/01/06/sqlite3_base/#删除表" class="headerlink" title="删除表"></a>删除表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">name</span>;</span><br></pre></td></tr></table></figure>
<h3 id="插入数据"><a href="/2017/01/06/sqlite3_base/#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><ol>
<li>insert into table_name (column1, column2, column3, …) values(value1, value2, value3, …)</li>
<li>insert into table_name values (value1, value2,value3, ..) : 为所有列添加值,且顺序按定义的来</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 第一种插入</span></span><br><span class="line"><span class="comment">-- 对于非空项必须插入</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">'paul'</span>, <span class="number">32</span>, <span class="string">'california'</span>, <span class="number">20000.0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">2</span>, <span class="string">'allen'</span>, <span class="number">22</span>, <span class="string">'texas'</span>, <span class="number">20000.0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">3</span>, <span class="string">'teddy'</span>, <span class="number">42</span>, <span class="string">'norway'</span>, <span class="number">15000.0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">4</span>, <span class="string">'mark'</span>, <span class="number">38</span>, <span class="string">'rich-mond'</span>, <span class="number">65000.0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">5</span>, <span class="string">'david'</span>, <span class="number">42</span>, <span class="string">'texas'</span>, <span class="number">85000.0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age, address, salary) <span class="keyword">values</span>(<span class="number">6</span>, <span class="string">'kim'</span>, <span class="number">42</span>, <span class="string">'south-hall'</span>, <span class="number">40000.0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company (<span class="keyword">id</span>, <span class="keyword">name</span>, age) <span class="keyword">values</span>(<span class="number">8</span>, <span class="string">'wade'</span>, <span class="number">33</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二种插入</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company <span class="keyword">values</span> (<span class="number">7</span>, <span class="string">'james'</span>, <span class="number">33</span>, <span class="string">'houston'</span>, <span class="number">10000.0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="select-语句-显示表中数据"><a href="/2017/01/06/sqlite3_base/#select-语句-显示表中数据" class="headerlink" title="select 语句, 显示表中数据"></a>select 语句, 显示表中数据</h3><h4 id="查看表中信息"><a href="/2017/01/06/sqlite3_base/#查看表中信息" class="headerlink" title="查看表中信息"></a>查看表中信息</h4><ol>
<li>有选择的查看: select column1, column2, columnN from table_name;</li>
<li>查看所有数据: select * from table_name;</li>
<li>为友好的查看数据, 可以使用:<ul>
<li>.header on</li>
<li>.mode column</li>
<li>.width 10,20,10</li>
</ul>
</li>
</ol>
<h4 id="查看数据库的表"><a href="/2017/01/06/sqlite3_base/#查看数据库的表" class="headerlink" title="查看数据库的表"></a>查看数据库的表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看数据库中创建的表</span></span><br><span class="line"><span class="keyword">select</span> tbl_name <span class="keyword">from</span> sqlite_master <span class="keyword">where</span> <span class="keyword">type</span>=<span class="string">'table'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出表中的完整信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sql</span> <span class="keyword">from</span> sqlite_master <span class="keyword">where</span> <span class="keyword">type</span>=<span class="string">'table'</span> <span class="keyword">and</span> tbl_name=<span class="string">'company'</span>;</span><br></pre></td></tr></table></figure>
<h4 id="算术运算符"><a href="/2017/01/06/sqlite3_base/#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h4><p><code>+ - * / %</code></p>
<h4 id="比较运算符"><a href="/2017/01/06/sqlite3_base/#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4><ol>
<li><code>== = != &lt;&gt;</code> : 是否相等或不等的;</li>
<li><code>&gt; &lt; &gt;= &lt;= !&lt; !&gt;</code> :大小比较;</li>
</ol>
<h4 id="逻辑运算符"><a href="/2017/01/06/sqlite3_base/#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><ol>
<li>AND      : 多个条件并存;</li>
<li>BETWEEN  : 给定一个范围;</li>
<li>EXISTS   : 在满足一定条件的指定表中搜索行的存在;</li>
<li>IN       : 指定值与一系列指定列表的值进行比较;</li>
<li>NOT IN   : 与IN相反;</li>
<li>LIKE     : 用于把某个值与使用通配符运算符的近似值进行比较;</li>
<li>GLOB     : 与LIKE类似,但是大小写敏感;</li>
<li>NOT      : 逻辑运算符的对立面, 如NOT EXISTS, NOT BETWEEN, NOT IN等;</li>
<li>OR       : 或;</li>
<li>IS NULL : 与NULL值进行比较的结果;</li>
<li>IS      : 与 = 运算符类似;</li>
<li>IS NOT  : 与 != 类似;</li>
<li>||      : 连接俩个不同的字符串, 得到一个新的字符串;</li>
</ol>
<h4 id="位运算符"><a href="/2017/01/06/sqlite3_base/#位运算符" class="headerlink" title="位运算符"></a>位运算符</h4><p><code>&amp; | ~ &gt;&gt; &lt;&lt;</code> : 与c语言中类似</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> age &gt;= <span class="number">25</span> <span class="keyword">AND</span> salary &gt;= <span class="number">65000</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> age &gt;= <span class="number">25</span> <span class="keyword">OR</span> salary &gt;= <span class="number">65000</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> salary <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'ki%'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'ki*'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> age <span class="keyword">IN</span>(<span class="number">32</span>, <span class="number">40</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> age <span class="keyword">NOT</span> <span class="keyword">IN</span>(<span class="number">32</span>, <span class="number">40</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> age <span class="keyword">BETWEEN</span> <span class="number">25</span> <span class="keyword">AND</span> <span class="number">27</span>;</span><br></pre></td></tr></table></figure>
<h3 id="sqlite-表达式"><a href="/2017/01/06/sqlite3_base/#sqlite-表达式" class="headerlink" title="sqlite 表达式"></a>sqlite 表达式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 布尔表达式</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> salary=<span class="number">10000</span>;</span><br><span class="line"><span class="comment">-- 数值表达式</span></span><br><span class="line"><span class="keyword">select</span> (<span class="number">3</span>+<span class="number">5</span>) <span class="keyword">as</span> addition;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="string">"records"</span> <span class="keyword">from</span> company;</span><br><span class="line"><span class="comment">-- 日期表达式</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">current_timestamp</span>;</span><br></pre></td></tr></table></figure>
<h3 id="update语句"><a href="/2017/01/06/sqlite3_base/#update语句" class="headerlink" title="update语句"></a>update语句</h3><p><code>用于修改表中的已有的记录, 可以使用带有where子句的update查询来更新选定行, 否则都会更新</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 更新一条记录</span></span><br><span class="line"><span class="keyword">update</span> company <span class="keyword">set</span> address=<span class="string">'zhengning'</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">6</span>;</span><br><span class="line"><span class="comment">-- 更新所有记录</span></span><br><span class="line"><span class="keyword">update</span> company <span class="keyword">set</span> address=<span class="string">'gansu'</span>, salary=<span class="number">33333</span>;</span><br></pre></td></tr></table></figure>
<h3 id="delete语句"><a href="/2017/01/06/sqlite3_base/#delete语句" class="headerlink" title="delete语句"></a>delete语句</h3><p><code>用于删除表中已有的记录, 可以使用带有where子句的delete查询来删除记录, 否则会全部删除</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除一条记录</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> company <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">6</span>;</span><br><span class="line"><span class="comment">-- 删除所有记录</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> company;</span><br></pre></td></tr></table></figure>
<h3 id="like-子句"><a href="/2017/01/06/sqlite3_base/#like-子句" class="headerlink" title="like 子句"></a>like 子句</h3><p><code>用来匹配通配符指定模式的文本值. 如果搜索表达式与模式表达式匹配,返回真; 通配符如下:</code></p>
<ul>
<li>百分号(%) : 代表0个, 1个或多个数字或字符;</li>
<li>下划线(_) : 代表一个单一的数字或字符;</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 通用式</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">column</span> <span class="keyword">like</span> [<span class="string">'xxxx%'</span> <span class="keyword">or</span> <span class="string">'%xxxx%'</span> <span class="keyword">or</span> <span class="string">'xxxx_'</span> <span class="keyword">or</span> <span class="string">'_xxxx'</span> <span class="keyword">or</span> <span class="string">'_xxxx_'</span>]</span><br><span class="line"><span class="comment">-- 一些例子</span></span><br><span class="line"><span class="comment">-- 查找以200开头的任意值</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> salary <span class="keyword">like</span> <span class="string">'200%'</span></span><br><span class="line"><span class="comment">-- 查找第二位为2, 且以3结尾的任意值</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">where</span> salary <span class="keyword">like</span> <span class="string">'_2%3'</span></span><br></pre></td></tr></table></figure>
<h3 id="glob-子句"><a href="/2017/01/06/sqlite3_base/#glob-子句" class="headerlink" title="glob 子句"></a>glob 子句</h3><p><code>用来匹配通配符指定模式的文本值. 与like不同的是, GLOB 是大小写敏感的; 通配符如下:</code></p>
<ul>
<li>星号(*) : 代表0个, 1个或多个字符或数字;</li>
<li>问好(?) : 一个单一的数字或字符;</li>
<li>例子同上;</li>
</ul>
<h3 id="limit-子句"><a href="/2017/01/06/sqlite3_base/#limit-子句" class="headerlink" title="limit 子句"></a>limit 子句</h3><h4 id="基本语法"><a href="/2017/01/06/sqlite3_base/#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基本的</span></span><br><span class="line"><span class="keyword">select</span> column1, column2, columnN <span class="keyword">from</span> tab_name <span class="keyword">limit</span> [<span class="keyword">no</span> <span class="keyword">of</span> <span class="keyword">rows</span>];</span><br><span class="line"><span class="comment">-- 返回从下一行开始直到给定的offset为止的所有行</span></span><br><span class="line"><span class="keyword">select</span> column1, column2, columnN <span class="keyword">from</span> tab_name <span class="keyword">limit</span> [<span class="keyword">no</span> <span class="keyword">of</span> <span class="keyword">rows</span>] <span class="keyword">offset</span> [<span class="keyword">row</span> <span class="keyword">num</span>];</span><br></pre></td></tr></table></figure>
<h4 id="实例"><a href="/2017/01/06/sqlite3_base/#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">limit</span> <span class="number">6</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">limit</span> <span class="number">3</span> <span class="keyword">offset</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h3 id="order-by-子句"><a href="/2017/01/06/sqlite3_base/#order-by-子句" class="headerlink" title="order by 子句"></a>order by 子句</h3><p><code>select column-list from table_name [where condition] [order by column1, column2, ] [asc(升)|desc(降)]</code></p>
<p>实例:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按薪水升序排列</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">-- 按薪水降序排列</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- name, 薪水</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">name</span>, salary <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="group-by-子句"><a href="/2017/01/06/sqlite3_base/#group-by-子句" class="headerlink" title="group by 子句"></a>group by 子句</h3><p><code>select column-list from table where [conditions] group by column1,columnN order by column1,columnN</code></p>
<p>实例:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果想了解客户的工资总额</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">into</span> company <span class="keyword">values</span>(<span class="number">9</span>, <span class="string">'teddy'</span>, <span class="number">42</span>, <span class="string">'ggg'</span>, <span class="number">90000</span>);</span><br><span class="line"><span class="comment">-- 添加一条记录就可以看的更透彻</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">name</span>,<span class="keyword">sum</span>(salary) <span class="keyword">from</span> company <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 与order by一起使用</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,<span class="keyword">sum</span>(salary) <span class="keyword">from</span> company <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">name</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="having-子句"><a href="/2017/01/06/sqlite3_base/#having-子句" class="headerlink" title="having 子句"></a>having 子句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">允许指定条件来过滤将出现在最终结果中的分组结果. where子句在所选列上设置条件, 而having子句则在由</span><br><span class="line">group by子句创建的分组上设置条件.</span><br></pre></td></tr></table></figure>
<h4 id="语法"><a href="/2017/01/06/sqlite3_base/#语法" class="headerlink" title="语法"></a>语法</h4><p><code>在select中的位置: select from where group by having order by, 必须在group by之后, order by之前.</code></p>
<h4 id="实例-1"><a href="/2017/01/06/sqlite3_base/#实例-1" class="headerlink" title="实例"></a>实例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 显示名称计数小于2的所有记录</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> company <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span> <span class="keyword">having</span> <span class="keyword">count</span>(<span class="keyword">name</span>)&lt;<span class="number">2</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> company <span class="keyword">values</span>(<span class="number">10</span>, <span class="string">'wade'</span>, <span class="number">34</span>, <span class="string">'waiami'</span>, <span class="number">33333</span>);</span><br><span class="line"><span class="comment">-- 添加上条记录后再观察效果</span></span><br></pre></td></tr></table></figure>
<h3 id="distinct-子句"><a href="/2017/01/06/sqlite3_base/#distinct-子句" class="headerlink" title="distinct 子句"></a>distinct 子句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">distinct关键字和select一起使用, 来消除所有重复的记录, 并只获取唯一一次记录. 有可能出现一种情况,</span><br><span class="line">在一个表中有多个重复的记录. 当提取这样的记录时, distinct关键字就显得有意义, 它只获取唯一一次记录,</span><br><span class="line">而不是重复获取.</span><br></pre></td></tr></table></figure>
<h4 id="语法-1"><a href="/2017/01/06/sqlite3_base/#语法-1" class="headerlink" title="语法"></a>语法</h4><p><code>select distinct column1,column2,columnN from table_name where [condition]</code></p>
<h4 id="例子"><a href="/2017/01/06/sqlite3_base/#例子" class="headerlink" title="例子"></a>例子</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 返回的记录中有重复的</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> company;</span><br><span class="line"><span class="comment">-- 返回不重复的记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">name</span> <span class="keyword">from</span> company;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/05/ndk_always/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/05/ndk_always/" itemprop="url">
                  NDK常用备份
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-01-05 14:21:36" itemprop="dateCreated datePublished" datetime="2017-01-05T14:21:36+08:00">2017-01-05</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="目的"><a href="/2017/01/05/ndk_always/#目的" class="headerlink" title="目的"></a>目的</h1><p><strong>主要是在使用JNI的时候, 经常有些基本内容要去网上找, 有时比较繁琐, 故在此记录</strong></p>
<h2 id="一些重要的网址"><a href="/2017/01/05/ndk_always/#一些重要的网址" class="headerlink" title="一些重要的网址"></a>一些重要的网址</h2><p><a href="http://blog.csdn.net/a345017062/article/category/1256568" target="_blank" rel="noopener">关于JNI官方中文规范的一系列讲解</a></p>
<h2 id="Java-jni-与-c-数据类型对照图"><a href="/2017/01/05/ndk_always/#Java-jni-与-c-数据类型对照图" class="headerlink" title="Java, jni 与 c++ 数据类型对照图"></a>Java, jni 与 c++ 数据类型对照图</h2><p><strong>基本数据类型:</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Java类型</th>
<th style="text-align:left">Jni类型</th>
<th style="text-align:left">c++类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">boolean</td>
<td style="text-align:left">jboolean</td>
<td style="text-align:left">unsigned char</td>
<td style="text-align:left">无符号8位整数</td>
</tr>
<tr>
<td style="text-align:left">byte</td>
<td style="text-align:left">jbyte</td>
<td style="text-align:left">signed char</td>
<td style="text-align:left">有符号8位整数</td>
</tr>
<tr>
<td style="text-align:left">char</td>
<td style="text-align:left">jchar</td>
<td style="text-align:left">unsigned short</td>
<td style="text-align:left">无符号16位整数</td>
</tr>
<tr>
<td style="text-align:left">short</td>
<td style="text-align:left">jshort</td>
<td style="text-align:left">signed short</td>
<td style="text-align:left">有符号16位整数</td>
</tr>
<tr>
<td style="text-align:left">int</td>
<td style="text-align:left">jint</td>
<td style="text-align:left">signed int</td>
<td style="text-align:left">有符号32位整数</td>
</tr>
<tr>
<td style="text-align:left">long</td>
<td style="text-align:left">jlong</td>
<td style="text-align:left">long long</td>
<td style="text-align:left">有符号64位整数</td>
</tr>
<tr>
<td style="text-align:left">float</td>
<td style="text-align:left">jfloat</td>
<td style="text-align:left">float</td>
<td style="text-align:left">有符号32位浮点数</td>
</tr>
<tr>
<td style="text-align:left">double</td>
<td style="text-align:left">jdouble</td>
<td style="text-align:left">double</td>
<td style="text-align:left">有符号64位浮点数</td>
</tr>
</tbody>
</table>
<p><strong>对象类型:</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Java类型</th>
<th style="text-align:left">Jni类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Object</td>
<td style="text-align:left">jobject</td>
<td style="text-align:left">任意Java对象</td>
</tr>
<tr>
<td style="text-align:left">Class</td>
<td style="text-align:left">jclass</td>
<td style="text-align:left">Class 对象,Java类</td>
</tr>
<tr>
<td style="text-align:left">String</td>
<td style="text-align:left">jstring</td>
<td style="text-align:left">字符串对象</td>
</tr>
</tbody>
</table>
<p><strong>类型对应的签名:</strong></p>
<p><img src="/2017/01/05/ndk_always//2017/01/05/ndk_always/001_type.png" alt=""></p>
<h2 id="native接口命名规则"><a href="/2017/01/05/ndk_always/#native接口命名规则" class="headerlink" title="native接口命名规则"></a>native接口命名规则</h2><p><strong>对于传统的JNI编程来说，JNI方法跟Java类方法的名称之间有一定的对应关系，要遵循一定的命名规则，如下：</strong></p>
<ol>
<li>前缀： Java_</li>
<li>类的全限定名，用下划线<code>_</code>进行分隔, 如: com_lms_jni_JniTest</li>
<li>方法名一般以小写开头, 一般函数名中间不使用下划线<code>_</code>, 如果使用下划线的话则可能需要使用动态注册方法,如：getTestString</li>
<li>jni函数指定第一个参数： JNIEnv *</li>
<li>jni函数指定第二个参数： jobject</li>
<li>实际Java参数： jstring, jint ….</li>
<li><p>返回值的参数 : jstring, jint…. 所以对于在Java类 com.dasea.jni.JniDemo中的一个方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">addTail</span><span class="params">(<span class="keyword">int</span>, String tail, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">addTailOne</span><span class="params">(<span class="keyword">int</span>, String tail, <span class="keyword">int</span>[] arr)</span></span>;</span><br></pre></td></tr></table></figure>
<p><strong>其对应的jni层的native函数声明如下:</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">jstring <span class="title">Java_com_dasea_jni_JniDemo_addTail</span><span class="params">(JNIEnv* env, jobject obj, jint, jstring, jint)</span></span>;</span><br><span class="line"><span class="comment">// 函数签名: (ILjava/util/String;I)Ljava/util/String;</span></span><br><span class="line"></span><br><span class="line"><span class="function">jstring <span class="title">Java_com_dasea_jni_JniDemo_addTail</span><span class="params">(JNIEnv* env, jobject obj, jint, jstring, jintArray)</span></span>;</span><br><span class="line"><span class="comment">// 函数签名: (ILjava/util/String;[I)Ljava/util/String;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/20/base64/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/20/base64/" itemprop="url">
                  base64 编解码
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-12-20 17:04:52" itemprop="dateCreated datePublished" datetime="2016-12-20T17:04:52+08:00">2016-12-20</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="base64-基本知识"><a href="/2016/12/20/base64/#base64-基本知识" class="headerlink" title="base64 基本知识"></a>base64 基本知识</h2><p><code>base64是将二进制数据转换为64个可打印字符的转换方式.</code></p>
<h2 id="base64-编码"><a href="/2016/12/20/base64/#base64-编码" class="headerlink" title="base64 编码"></a>base64 编码</h2><p><code>将三字节转为四字节</code>, 如下:</p>
<p><img src="/2016/12/20/base64//2016/12/20/base64/png/base3_4.png" alt=""></p>
<p><code>如果不是三的整数倍, 则补0; 根据补的0的个数, 需要在结果字符串的最后面添加&#39;=&#39;</code></p>
<p>实现如下:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> base64_chars = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">base64_encode</span><span class="params">(<span class="keyword">uint8_t</span>* in, <span class="keyword">uint32_t</span> inLen)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> arrayIn[<span class="number">3</span>]  = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> arrayOut[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断是否是</span></span><br><span class="line">    <span class="keyword">uint32_t</span> round = (<span class="keyword">uint32_t</span>)(inLen / <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">uint32_t</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">uint32_t</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">uint8_t</span>&gt; outRet;</span><br><span class="line">    <span class="keyword">while</span> (i++ &lt; round) &#123;</span><br><span class="line">        arrayIn[<span class="number">0</span>] = in[j++];</span><br><span class="line">        arrayIn[<span class="number">1</span>] = in[j++];</span><br><span class="line">        arrayIn[<span class="number">2</span>] = in[j++];</span><br><span class="line"></span><br><span class="line">        arrayOut[<span class="number">0</span>] = ((arrayIn[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        arrayOut[<span class="number">1</span>] = ((arrayIn[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        arrayOut[<span class="number">2</span>] = ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>) + ((arrayIn[<span class="number">2</span>] &amp; <span class="number">0xc0</span>) &gt;&gt; <span class="number">6</span>);</span><br><span class="line">        arrayOut[<span class="number">3</span>] = (arrayIn[<span class="number">2</span>] &amp; <span class="number">0x3f</span>);</span><br><span class="line"></span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">0</span>]]);</span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">1</span>]]);</span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">2</span>]]);</span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">3</span>]]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果不是三的倍数的话</span></span><br><span class="line">    <span class="comment">// 处理余下的内容, 如果添加的话, 需要=号</span></span><br><span class="line">    round = (<span class="keyword">uint32_t</span>)(inLen % <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span> == round) &#123;</span><br><span class="line">        arrayIn[<span class="number">0</span>] = in[inLen - <span class="number">1</span>];</span><br><span class="line">        arrayIn[<span class="number">1</span>] = <span class="string">'\0'</span>;</span><br><span class="line"></span><br><span class="line">        arrayOut[<span class="number">0</span>] = ((arrayIn[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        arrayOut[<span class="number">1</span>] = ((arrayIn[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">0</span>]]);</span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">1</span>]]);</span><br><span class="line">        <span class="comment">// outRet.push_back('=');</span></span><br><span class="line">        <span class="comment">// outRet.push_back('=');</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">2</span> == round) &#123;</span><br><span class="line">        arrayIn[<span class="number">0</span>] = in[inLen - <span class="number">2</span>];</span><br><span class="line">        arrayIn[<span class="number">1</span>] = in[inLen - <span class="number">1</span>];</span><br><span class="line">        arrayIn[<span class="number">2</span>] = <span class="string">'\0'</span>;</span><br><span class="line"></span><br><span class="line">        arrayOut[<span class="number">0</span>] = ((arrayIn[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        arrayOut[<span class="number">1</span>] = ((arrayIn[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        arrayOut[<span class="number">2</span>] = ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>) + ((arrayIn[<span class="number">2</span>] &amp; <span class="number">0xc0</span>) &gt;&gt; <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">0</span>]]);</span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">1</span>]]);</span><br><span class="line">        outRet.push_back(base64_chars[arrayOut[<span class="number">2</span>]]);</span><br><span class="line">        <span class="comment">// outRet.push_back('=');</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// vec 转 string</span></span><br><span class="line">    std::string out(outRet.begin(), outRet.end());</span><br><span class="line">    <span class="keyword">return</span> (out);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="base64-解码"><a href="/2016/12/20/base64/#base64-解码" class="headerlink" title="base64 解码"></a>base64 解码</h2><p><code>将四个字节转换为三个字节, 上面的逆过程.</code></p>
<p>实现如下:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uint8_t</span>* base64_decode(<span class="built_in">std</span>::<span class="built_in">string</span>&amp; in, <span class="keyword">uint32_t</span>&amp; outLen) &#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> arrayIn[<span class="number">4</span>]  = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> arrayOut[<span class="number">3</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uint32_t</span> round = (<span class="keyword">uint32_t</span>)(in.size() / <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">uint32_t</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">uint32_t</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">uint8_t</span>&gt; vecRet;</span><br><span class="line">    <span class="keyword">while</span> (i++ &lt; round) &#123;</span><br><span class="line">        arrayIn[<span class="number">0</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[j++]));</span><br><span class="line">        arrayIn[<span class="number">1</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[j++]));</span><br><span class="line">        arrayIn[<span class="number">2</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[j++]));</span><br><span class="line">        arrayIn[<span class="number">3</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[j++]));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 转换</span></span><br><span class="line">        arrayOut[<span class="number">0</span>] = (arrayIn[<span class="number">0</span>] &lt;&lt; <span class="number">2</span>) + ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x30</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        arrayOut[<span class="number">1</span>] = ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">4</span>) + ((arrayIn[<span class="number">2</span>] &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        arrayOut[<span class="number">2</span>] = ((arrayIn[<span class="number">2</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">6</span>) + arrayIn[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 三个数已知</span></span><br><span class="line">        vecRet.push_back(arrayOut[<span class="number">0</span>]);</span><br><span class="line">        vecRet.push_back(arrayOut[<span class="number">1</span>]);</span><br><span class="line">        vecRet.push_back(arrayOut[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果不是4的整数倍, 则其他的单独进行</span></span><br><span class="line">    round = (<span class="keyword">uint32_t</span>)(in.size() % <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">2</span> == round) &#123;</span><br><span class="line">        <span class="comment">// 可转换为一个字符</span></span><br><span class="line">        arrayIn[<span class="number">0</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[in.size() - <span class="number">2</span>]));</span><br><span class="line">        arrayIn[<span class="number">1</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[in.size() - <span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        arrayOut[<span class="number">0</span>] = (arrayIn[<span class="number">0</span>] &lt;&lt; <span class="number">2</span>) + ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x30</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        vecRet.push_back(arrayOut[<span class="number">0</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">3</span> == round) &#123;</span><br><span class="line">        <span class="comment">// 可转换为2个字符</span></span><br><span class="line">        arrayIn[<span class="number">0</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[in.size() - <span class="number">3</span>]));</span><br><span class="line">        arrayIn[<span class="number">1</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[in.size() - <span class="number">2</span>]));</span><br><span class="line">        arrayIn[<span class="number">2</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">uint8_t</span>&gt;(base64_chars.find(in[in.size() - <span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        arrayOut[<span class="number">0</span>] = (arrayIn[<span class="number">0</span>] &lt;&lt; <span class="number">2</span>) + ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x30</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        arrayOut[<span class="number">1</span>] = ((arrayIn[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">4</span>) + ((arrayIn[<span class="number">2</span>] &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        vecRet.push_back(arrayOut[<span class="number">0</span>]);</span><br><span class="line">        vecRet.push_back(arrayOut[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    outLen = vecRet.size();</span><br><span class="line">    <span class="keyword">uint8_t</span>* ret = <span class="keyword">new</span> <span class="keyword">uint8_t</span>[outLen];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; outLen; ++i) &#123;</span><br><span class="line">        ret[i] = vecRet[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/13/bash_learn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/13/bash_learn/" itemprop="url">
                  bash, zsh学习记录
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-12-13 10:29:48" itemprop="dateCreated datePublished" datetime="2016-12-13T10:29:48+08:00">2016-12-13</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基本的"><a href="/2016/12/13/bash_learn/#基本的" class="headerlink" title="基本的"></a>基本的</h1><h2 id="返回值"><a href="/2016/12/13/bash_learn/#返回值" class="headerlink" title="返回值"></a>返回值</h2><p>每个命令都有一个<strong>返回值</strong>（<strong>返回状态</strong>或者<strong>退出状态</strong>）。命令执行成功的返回值总是<code>0</code>（零值），执行失败的命令，返回一个非0值（错误码）。错误码必须是一个1到255之间的整数。</p>
<p>在编写脚本时，另一个很有用的命令是<code>exit</code>。这个命令被用来终止当前的执行，并把返回值交给shell。当<code>exit</code>不带任何参数时，它会终止当前脚本的执行并返回在它之前最后一个执行的命令的返回值。</p>
<p>一个程序运行结束后，shell将其<strong>返回值</strong>赋值给<code>$?</code>环境变量。因此<code>$?</code>变量通常被用来检测一个脚本执行成功与否。</p>
<p>与使用<code>exit</code>来结束一个脚本的执行类似，我们可以使用<code>return</code>命令来结束一个函数的执行并将<strong>返回值</strong>返回给调用者。当然，也可以在函数内部用<code>exit</code>，这 _不但_ 会中止函数的继续执行，_而且_ 会终止整个程序的执行。</p>
<h2 id="注释"><a href="/2016/12/13/bash_learn/#注释" class="headerlink" title="注释"></a>注释</h2><p>脚本中可以包含 _注释_。注释是特殊的语句，会被<code>shell</code>解释器忽略。它们以<code>#</code>开头，到行尾结束。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># This script will print your username.</span></span><br><span class="line">whoami</span><br></pre></td></tr></table></figure>
<h1 id="变量"><a href="/2016/12/13/bash_learn/#变量" class="headerlink" title="变量"></a>变量</h1><p>Bash中没有数据类型。变量只能包含数字或者由一个或多个字符组成的字符串<br>你可以创建三种变量：局部变量，环境变量以及作为 <em>位置参数</em> 的变量。</p>
<h2 id="局部变量"><a href="/2016/12/13/bash_learn/#局部变量" class="headerlink" title="局部变量"></a>局部变量</h2><p><strong>局部变量</strong> 是仅在某个脚本内部有效的变量。它们不能被其他的程序和脚本访问。</p>
<p>局部变量可以用<code>=</code>声明（作为一种约定，变量名、<code>=</code>、变量的值之间 <strong>不应该</strong> 有空格）,<br>其值可以用<code>$</code>访问到。举个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="string">"denysdovhan"</span>  <span class="comment"># 声明变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$username</span>          <span class="comment"># 输出变量的值</span></span><br><span class="line"><span class="built_in">unset</span> username          <span class="comment"># 删除变量</span></span><br></pre></td></tr></table></figure>
<p>也可以用<code>local</code>关键字声明属于某个函数的局部变量,这样声明的变量会在函数结束时消失。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">local</span> local_var=<span class="string">"I'm a local value"</span></span><br></pre></td></tr></table></figure>
<h2 id="环境变量"><a href="/2016/12/13/bash_learn/#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><p><strong>环境变量</strong> 是对当前shell会话内所有的程序或脚本都可见的变量.<br>创建它们跟创建局部变量类似，但使用的是<code>export</code>关键字。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GLOBAL_VAR=<span class="string">"I'm a global variable"</span></span><br></pre></td></tr></table></figure>
<p>bash中有 <em>非常多</em> 的环境变量。你会非常频繁地遇到它们，这里有一张速查表，记录了在实践中最常见的环境变量。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Variable</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>$HOME</code></td>
<td style="text-align:left">当前用户的用户目录</td>
</tr>
<tr>
<td style="text-align:left"><code>$PATH</code></td>
<td style="text-align:left">用分号分隔的目录列表，shell会到这些目录中查找命令</td>
</tr>
<tr>
<td style="text-align:left"><code>$PWD</code></td>
<td style="text-align:left">当前工作目录</td>
</tr>
<tr>
<td style="text-align:left"><code>$RANDOM</code></td>
<td style="text-align:left">0到32767之间的整数</td>
</tr>
<tr>
<td style="text-align:left"><code>$UID</code></td>
<td style="text-align:left">数值类型，当前用户的用户ID</td>
</tr>
<tr>
<td style="text-align:left"><code>$PS1</code></td>
<td style="text-align:left">主要系统输入提示符</td>
</tr>
<tr>
<td style="text-align:left"><code>$PS2</code></td>
<td style="text-align:left">次要系统输入提示符</td>
</tr>
</tbody>
</table>
<p><a href="http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02.html#sect_03_02_04" target="_blank" rel="noopener">查看更多</a></p>
<h2 id="位置参数"><a href="/2016/12/13/bash_learn/#位置参数" class="headerlink" title="位置参数"></a>位置参数</h2><p><strong>位置参数</strong> 是在调用一个函数并传给它参数时创建的变量。下表列出了在函数中，位置参数变量和一些其它的特殊变量以及它们的意义。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Parameter</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>$0</code></td>
<td style="text-align:left">脚本名称</td>
</tr>
<tr>
<td style="text-align:left"><code>$1 … $9</code></td>
<td style="text-align:left">第1个到第9个参数列表</td>
</tr>
<tr>
<td style="text-align:left"><code>${10} … ${N}</code></td>
<td style="text-align:left">第10个到N个参数列表</td>
</tr>
<tr>
<td style="text-align:left"><code>$*</code> or <code>$@</code></td>
<td style="text-align:left">除了<code>$0</code>外的所有位置参数</td>
</tr>
<tr>
<td style="text-align:left"><code>$#</code></td>
<td style="text-align:left">不包括<code>$0</code>在内的位置参数的个数</td>
</tr>
<tr>
<td style="text-align:left"><code>$FUNCNAME</code></td>
<td style="text-align:left">函数名称（仅在函数内部有值）</td>
</tr>
</tbody>
</table>
<p>在下面的例子中，位置参数为：<code>$0=&#39;./script.sh&#39;</code>，<code>$1=&#39;foo&#39;</code>，<code>$2=&#39;bar&#39;</code>：</p>
<pre><code>./script.sh foo bar
</code></pre><p>变量可以有 _默认_ 值。我们可以用如下语法来指定默认值：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 如果变量为空，赋给他们默认值</span></span><br><span class="line">: <span class="variable">$&#123;VAR:='default'&#125;</span></span><br><span class="line">: <span class="variable">$&#123;$1:='first'&#125;</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">FOO=<span class="variable">$&#123;FOO:-'default'&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="Shell扩展"><a href="/2016/12/13/bash_learn/#Shell扩展" class="headerlink" title="Shell扩展"></a>Shell扩展</h1><p>_扩展_ 发生在一行命令被分成一个个的 <em>记号（tokens）</em> 之后。换言之，扩展是一种执行数学运算的机制，还可以用来保存命令的执行结果，等等。</p>
<p><a href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Expansions" target="_blank" rel="noopener">shell扩展的更多细节</a>。</p>
<h2 id="大括号扩展"><a href="/2016/12/13/bash_learn/#大括号扩展" class="headerlink" title="大括号扩展"></a>大括号扩展</h2><p>大括号扩展让生成任意的字符串成为可能。它跟 <em>文件名扩展</em> 很类似，举个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> beg&#123;i,a,u&#125;n <span class="comment"># begin began begun</span></span><br></pre></td></tr></table></figure>
<p>大括号扩展还可以用来创建一个可被循环迭代的区间。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> &#123;0..5&#125; <span class="comment"># 0 1 2 3 4 5</span></span><br><span class="line"><span class="built_in">echo</span> &#123;00..8..2&#125; <span class="comment"># 00 02 04 06 08</span></span><br></pre></td></tr></table></figure>
<h2 id="命令置换"><a href="/2016/12/13/bash_learn/#命令置换" class="headerlink" title="命令置换"></a>命令置换</h2><p>命令置换允许我们对一个命令求值，并将其值置换到另一个命令或者变量赋值表达式中。当一个命令被<figure class="highlight plain"><figcaption><span>```或`$()`包围时，命令置换将会执行。举个例子：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```bash</span><br><span class="line">now=`date +%T`</span><br><span class="line"># or</span><br><span class="line">now=$(date +%T)</span><br><span class="line"></span><br><span class="line">echo $now # 19:08:26</span><br></pre></td></tr></table></figure></p>
<h2 id="算数扩展"><a href="/2016/12/13/bash_learn/#算数扩展" class="headerlink" title="算数扩展"></a>算数扩展</h2><p>在bash中，执行算数运算是非常方便的。算数表达式必须包在<code>$(( ))</code>中。算数扩展的格式为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result=$(( ((10 + 5*3) - 7) / 2 ))</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$result</span> <span class="comment"># 9</span></span><br></pre></td></tr></table></figure>
<p>在算数表达式中，使用变量无需带上<code>$</code>前缀：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x=4</span><br><span class="line">y=7</span><br><span class="line"><span class="built_in">echo</span> $(( x + y ))     <span class="comment"># 11</span></span><br><span class="line"><span class="built_in">echo</span> $(( ++x + y++ )) <span class="comment"># 12</span></span><br><span class="line"><span class="built_in">echo</span> $(( x + y ))     <span class="comment"># 13</span></span><br></pre></td></tr></table></figure>
<h2 id="单引号和双引号"><a href="/2016/12/13/bash_learn/#单引号和双引号" class="headerlink" title="单引号和双引号"></a>单引号和双引号</h2><p>单引号和双引号之间有很重要的区别。在双引号中，变量引用或者命令置换是会被展开的.<br>在单引号中是不会的。双引号中, 对于变量可以扩展, 但是不用于扩展通配符; 单引号都<br>展开,举个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"Your home: <span class="variable">$HOME</span>"</span> <span class="comment"># Your home: /Users/&lt;username&gt;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Your home: $HOME'</span> <span class="comment"># Your home: $HOME</span></span><br></pre></td></tr></table></figure>
<p>当局部变量和环境变量包含空格时，它们在引号中的扩展要格外注意。随便举个例子，假如我们用<code>echo</code>来输出用户的输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INPUT=<span class="string">"A string  with   strange    whitespace."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$INPUT</span>   <span class="comment"># A string with strange whitespace.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$INPUT</span>"</span> <span class="comment"># A string  with   strange    whitespace.</span></span><br></pre></td></tr></table></figure>
<p>调用第一个<code>echo</code>时给了它5个单独的参数 —— $INPUT被分成了单独的词，<code>echo</code>在每个词之间打印了一个空格。第二种情况，调用<code>echo</code>时只给了它一个参数（整个$INPUT的值，包括其中的空格）。</p>
<p>来看一个更严肃的例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FILE=<span class="string">"Favorite Things.txt"</span></span><br><span class="line">cat <span class="variable">$FILE</span>   <span class="comment"># 尝试输出两个文件: `Favorite` 和 `Things.txt`</span></span><br><span class="line">cat <span class="string">"<span class="variable">$FILE</span>"</span> <span class="comment"># 输出一个文件: `Favorite Things.txt`</span></span><br></pre></td></tr></table></figure>
<p>尽管这个问题可以通过把FILE重命名成<code>Favorite-Things.txt</code>来解决，但是，假如这个值来自某个环境变量，来自一个位置参数，或者来自其它命令（<code>find</code>, <code>cat</code>, 等等）呢。因此，如果输入 <em>可能</em> 包含空格，务必要用引号把表达式包起来。</p>
<h1 id="数组"><a href="/2016/12/13/bash_learn/#数组" class="headerlink" title="数组"></a>数组</h1><p>跟其它程序设计语言一样，bash中的数组变量给了你引用多个值的能力。在bash中，数组下标也是从0开始，也就是说，第一个元素的下标是0。</p>
<p>跟数组打交道时，要注意一个特殊的环境变量<code>IFS</code>。<strong>IFS</strong>，全称 <strong>Input Field Separator</strong>，保存了数组中元素的分隔符。它的默认值是一个空格<code>IFS=&#39; &#39;</code>。</p>
<h2 id="数组声明"><a href="/2016/12/13/bash_learn/#数组声明" class="headerlink" title="数组声明"></a>数组声明</h2><p>在bash中，可以通过简单地给数组变量的某个下标赋值来创建一个数组：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fruits[0]=Apple</span><br><span class="line">fruits[1]=Pear</span><br><span class="line">fruits[2]=Plum</span><br></pre></td></tr></table></figure>
<p>数组变量也可以通过复合赋值的方式来创建，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fruits=(Apple Pear Plum)</span><br></pre></td></tr></table></figure>
<h2 id="数组扩展"><a href="/2016/12/13/bash_learn/#数组扩展" class="headerlink" title="数组扩展"></a>数组扩展</h2><p>单个数组元素的扩展跟普通变量的扩展类似：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;fruits[1]&#125;</span> <span class="comment"># Pear</span></span><br></pre></td></tr></table></figure>
<p>整个数组可以通过把数字下标换成<code>*</code>或<code>@</code>来扩展：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;fruits[*]&#125;</span> <span class="comment"># Apple Pear Plum</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;fruits[@]&#125;</span> <span class="comment"># Apple Pear Plum</span></span><br></pre></td></tr></table></figure>
<p>上面两行有很重要（也很微妙）的区别，假设某数组元素中包含空格：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fruits[0]=Apple</span><br><span class="line">fruits[1]=<span class="string">"Desert fig"</span></span><br><span class="line">fruits[2]=Plum</span><br></pre></td></tr></table></figure>
<p>为了将数组中每个元素单独一行输出，我们用内建的<code>printf</code>命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="variable">$&#123;fruits[*]&#125;</span></span><br><span class="line"><span class="comment"># + Apple</span></span><br><span class="line"><span class="comment"># + Desert</span></span><br><span class="line"><span class="comment"># + fig</span></span><br><span class="line"><span class="comment"># + Plum</span></span><br></pre></td></tr></table></figure>
<p>为什么<code>Desert</code>和<code>fig</code>各占了一行？尝试用引号包起来：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$&#123;fruits[*]&#125;</span>"</span></span><br><span class="line"><span class="comment"># + Apple Desert fig Plum</span></span><br></pre></td></tr></table></figure>
<p>现在所有的元素都跑去了一行 —— 这不是我们想要的！为了解决这个痛点，<code>${fruits[@]}</code>闪亮登场：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$&#123;fruits[@]&#125;</span>"</span></span><br><span class="line"><span class="comment"># + Apple</span></span><br><span class="line"><span class="comment"># + Desert fig</span></span><br><span class="line"><span class="comment"># + Plum</span></span><br></pre></td></tr></table></figure>
<p>在引号内，<code>${fruits[@]}</code>将数组中的每个元素扩展为一个单独的参数；数组元素中的空格得以保留。</p>
<h2 id="数组切片"><a href="/2016/12/13/bash_learn/#数组切片" class="headerlink" title="数组切片"></a>数组切片</h2><p>除此之外，可以通过 _切片_ 运算符来取出数组中的某一片元素：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;fruits[@]:0:2&#125;</span> <span class="comment"># Apple Desert fig</span></span><br></pre></td></tr></table></figure>
<p>在上面的例子中，<code>${fruits[@]}</code>扩展为整个数组，<code>:0:2</code>取出了数组中从0开始，长度为2的元素。</p>
<h2 id="向数组中添加元素"><a href="/2016/12/13/bash_learn/#向数组中添加元素" class="headerlink" title="向数组中添加元素"></a>向数组中添加元素</h2><p>向数组中添加元素也非常简单。复合赋值在这里显得格外有用。我们可以这样做：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fruits=(Orange <span class="string">"<span class="variable">$&#123;fruits[@]&#125;</span>"</span> Banana Cherry)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;fruits[@]&#125;</span> <span class="comment"># Orange Apple Desert fig Plum Banana Cherry</span></span><br></pre></td></tr></table></figure>
<p>上面的例子中，<code>${fruits[@]}</code>扩展为整个数组，并被置换到复合赋值语句中，接着，对数组<code>fruits</code>的赋值覆盖了它原来的值。</p>
<h2 id="从数组中删除元素"><a href="/2016/12/13/bash_learn/#从数组中删除元素" class="headerlink" title="从数组中删除元素"></a>从数组中删除元素</h2><p>用<code>unset</code>命令来从数组中删除一个元素：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> fruits[0]</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;fruits[@]&#125;</span> <span class="comment"># Apple Desert fig Plum Banana Cherry</span></span><br></pre></td></tr></table></figure>
<h1 id="流，管道以及序列"><a href="/2016/12/13/bash_learn/#流，管道以及序列" class="headerlink" title="流，管道以及序列"></a>流，管道以及序列</h1><p>Bash有很强大的工具来处理程序之间的协同工作。使用流，我们能将一个程序的输出发送到另一个程序或文件，因此，我们能方便地记录日志或做一些其它我们想做的事。</p>
<p>管道给了我们创建传送带的机会，控制程序的执行成为可能。</p>
<p>学习如何使用这些强大的、高级的工具是非常非常重要的。</p>
<h2 id="流"><a href="/2016/12/13/bash_learn/#流" class="headerlink" title="流"></a>流</h2><p>Bash接收输入，并以字符序列或 <strong>字符流</strong> 的形式产生输出。这些流能被重定向到文件或另一个流中。</p>
<p>有三个文件描述符：</p>
<table>
<thead>
<tr>
<th style="text-align:center">代码</th>
<th style="text-align:center">描述符</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>0</code></td>
<td style="text-align:center"><code>stdin</code></td>
<td style="text-align:left">标准输入</td>
</tr>
<tr>
<td style="text-align:center"><code>1</code></td>
<td style="text-align:center"><code>stdout</code></td>
<td style="text-align:left">标准输出</td>
</tr>
<tr>
<td style="text-align:center"><code>2</code></td>
<td style="text-align:center"><code>stderr</code></td>
<td style="text-align:left">标准错误输出</td>
</tr>
</tbody>
</table>
<p>重定向让我们可以控制一个命令的输入来自哪里，输出结果到什么地方。这些运算符在控制流的重定向时会被用到：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Operator</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>&gt;</code></td>
<td style="text-align:left">重定向输出</td>
</tr>
<tr>
<td style="text-align:center"><code>&amp;&gt;</code></td>
<td style="text-align:left">重定向输出和错误输出</td>
</tr>
<tr>
<td style="text-align:center"><code>&amp;&gt;&gt;</code></td>
<td style="text-align:left">以附加的形式重定向输出和错误输出</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;</code></td>
<td style="text-align:left">重定向输入</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;&lt;</code></td>
<td style="text-align:left"><a href="http://tldp.org/LDP/abs/html/here-docs.html" target="_blank" rel="noopener">Here文档</a> 语法</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;&lt;&lt;</code></td>
<td style="text-align:left"><a href="http://www.tldp.org/LDP/abs/html/x17837.html" target="_blank" rel="noopener">Here字符串</a></td>
</tr>
</tbody>
</table>
<p>以下是一些使用重定向的例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ls的结果将会被写到list.txt中</span></span><br><span class="line">ls -l &gt; list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将输出附加到list.txt中</span></span><br><span class="line">ls -a &gt;&gt; list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有的错误信息会被写到errors.txt中</span></span><br><span class="line">grep da * 2&gt; errors.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从errors.txt中读取输入</span></span><br><span class="line">less &lt; errors.txt</span><br></pre></td></tr></table></figure>
<h2 id="管道"><a href="/2016/12/13/bash_learn/#管道" class="headerlink" title="管道"></a>管道</h2><p>我们不仅能将流重定向到文件中，还能重定向到其它程序中。<strong>管道</strong> 允许我们把一个程序的输出当做另一个程序的输入。</p>
<p>在下面的例子中，<code>command1</code>把它的输出发送给了<code>command2</code>，然后输出被传递到<code>command3</code>：</p>
<pre><code>command1 | command2 | command3
</code></pre><p>这样的结构被称作 <strong>管道</strong>。</p>
<p>在实际操作中，这可以用来在多个程序间依次处理数据。在下面的例子中，<code>ls -l</code>的输出被发送给了<code>grep</code>，来打印出扩展名是<code>.md</code>的文件，它的输出最终发送给了<code>less</code>：</p>
<pre><code>ls -l | grep .md$ | less
</code></pre><p>管道的返回值通常是管道中最后一个命令的返回值。shell会等到管道中所有的命令都结束后，才会返回一个值。如果你想让管道中任意一个命令失败后，管道就宣告失败，那么需要用下面的命令设置pipefail选项：</p>
<pre><code>set -o pipefail
</code></pre><h2 id="命令序列"><a href="/2016/12/13/bash_learn/#命令序列" class="headerlink" title="命令序列"></a>命令序列</h2><p>命令序列是由<code>;</code>，<code>&amp;</code>，<code>&amp;&amp;</code>或者<code>||</code>运算符分隔的一个或多个管道序列。</p>
<p>如果一个命令以<code>&amp;</code>结尾，shell将会在一个子shell中异步执行这个命令。换句话说，这个命令将会在后台执行。</p>
<p>以<code>;</code>分隔的命令将会依次执行：一个接着一个。shell会等待直到每个命令执行完。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># command2 会在 command1 之后执行</span></span><br><span class="line">command1 ; command2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等同于这种写法</span></span><br><span class="line">command1</span><br><span class="line">command2</span><br></pre></td></tr></table></figure>
<p>以<code>&amp;&amp;</code>和<code>||</code>分隔的命令分别叫做 _与_ 和 _或_ 序列。</p>
<p><em>与序列</em> 看起来是这样的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当且仅当command1执行成功（返回0值）时，command2才会执行</span></span><br><span class="line">command1 &amp;&amp; command2</span><br></pre></td></tr></table></figure>
<p><em>或序列</em> 是下面这种形式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当且仅当command1执行失败（返回错误码）时，command2才会执行</span></span><br><span class="line">command1 || command2</span><br></pre></td></tr></table></figure>
<p>_与_ 或 _或_ 序列的返回值是序列中最后一个执行的命令的返回值。</p>
<h1 id="条件语句"><a href="/2016/12/13/bash_learn/#条件语句" class="headerlink" title="条件语句"></a>条件语句</h1><p>跟其它程序设计语言一样，Bash中的条件语句让我们可以决定一个操作是否被执行。结果取决于一个包在<code>[[ ]]</code>里的表达式。</p>
<p>条件表达式可以包含<code>&amp;&amp;</code>和<code>||</code>运算符，分别对应 _与_ 和 _或_ 。除此之外还有很多有用的<a href="/2016/12/13/bash_learn/#基元和组合表达式">表达式</a>。</p>
<p>共有两个不同的条件表达式：<code>if</code>和<code>case</code>。</p>
<h2 id="基元和组合表达式"><a href="/2016/12/13/bash_learn/#基元和组合表达式" class="headerlink" title="基元和组合表达式"></a>基元和组合表达式</h2><p>由<code>[[ ]]</code>（<code>sh</code>中是<code>[ ]</code>）包起来的表达式被称作 <strong>检测命令</strong> 或 <strong>基元</strong>。这些表达式帮助我们检测一个条件的结果。在下面的表里，为了兼容<code>sh</code>，我们用的是<code>[ ]</code>。这里可以找到有关<a href="http://serverfault.com/a/52050" target="_blank" rel="noopener">bash中单双中括号区别</a>的答案。</p>
<p><strong>跟文件系统相关：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">基元</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>[ -e FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在 (<strong>e</strong>xists)，为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -f FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且为一个普通文件（<strong>f</strong>ile），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -d FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且为一个目录（<strong>d</strong>irectory），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -s FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且非空（<strong>s</strong>ize 大于0），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -r FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且有读权限（<strong>r</strong>eadable），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -w FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且有写权限（<strong>w</strong>ritable），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -x FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且有可执行权限（e<strong>x</strong>ecutable），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -L FILE ]</code></td>
<td style="text-align:left">如果<code>FILE</code>存在且为一个符号链接（<strong>l</strong>ink），为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ FILE1 -nt FILE2 ]</code></td>
<td style="text-align:left"><code>FILE1</code>比<code>FILE2</code>新（<strong>n</strong>ewer <strong>t</strong>han）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ FILE1 -ot FILE2 ]</code></td>
<td style="text-align:left"><code>FILE1</code>比<code>FILE2</code>旧（<strong>o</strong>lder <strong>t</strong>han）</td>
</tr>
</tbody>
</table>
<p><strong>跟字符串相关：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">基元</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>[ -z STR ]</code></td>
<td style="text-align:left"><code>STR</code>为空（长度为0，<strong>z</strong>ero）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ -n STR ]</code></td>
<td style="text-align:left"><code>STR</code>非空（长度非0，<strong>n</strong>on-zero）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ STR1 == STR2 ]</code></td>
<td style="text-align:left"><code>STR1</code>和<code>STR2</code>相等</td>
</tr>
<tr>
<td style="text-align:center"><code>[ STR1 != STR2 ]</code></td>
<td style="text-align:left"><code>STR1</code>和<code>STR2</code>不等</td>
</tr>
</tbody>
</table>
<p><strong>算数二元运算符：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">基元</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>[ ARG1 -eq ARG2 ]</code></td>
<td style="text-align:left"><code>ARG1</code>和<code>ARG2</code>相等（<strong>eq</strong>ual）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ ARG1 -ne ARG2 ]</code></td>
<td style="text-align:left"><code>ARG1</code>和<code>ARG2</code>不等（<strong>n</strong>ot <strong>e</strong>qual）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ ARG1 -lt ARG2 ]</code></td>
<td style="text-align:left"><code>ARG1</code>小于<code>ARG2</code>（<strong>l</strong>ess <strong>t</strong>han）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ ARG1 -le ARG2 ]</code></td>
<td style="text-align:left"><code>ARG1</code>小于等于<code>ARG2</code>（<strong>l</strong>ess than or <strong>e</strong>qual）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ ARG1 -gt ARG2 ]</code></td>
<td style="text-align:left"><code>ARG1</code>大于<code>ARG2</code>（<strong>g</strong>reater <strong>t</strong>han）</td>
</tr>
<tr>
<td style="text-align:center"><code>[ ARG1 -ge ARG2 ]</code></td>
<td style="text-align:left"><code>ARG1</code>大于等于<code>ARG2</code>（<strong>g</strong>reater than or <strong>e</strong>qual）</td>
</tr>
</tbody>
</table>
<p>条件语句可以跟 <strong>组合表达式</strong> 配合使用：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Operation</th>
<th style="text-align:left">Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>[ ! EXPR ]</code></td>
<td style="text-align:left">如果<code>EXPR</code>为假，为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ (EXPR) ]</code></td>
<td style="text-align:left">返回<code>EXPR</code>的值</td>
</tr>
<tr>
<td style="text-align:center"><code>[ EXPR1 -a EXPR2 ]</code></td>
<td style="text-align:left">逻辑 _与_， 如果<code>EXPR1</code>和（<strong>a</strong>nd）<code>EXPR2</code>都为真，为真</td>
</tr>
<tr>
<td style="text-align:center"><code>[ EXPR1 -o EXPR2 ]</code></td>
<td style="text-align:left">逻辑 _或_， 如果<code>EXPR1</code>或（<strong>o</strong>r）<code>EXPR2</code>为真，为真</td>
</tr>
</tbody>
</table>
<p>当然，还有很多有用的基元，在<a href="http://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html" target="_blank" rel="noopener">Bash的man页面</a>能很容易找到它们。</p>
<h2 id="使用if"><a href="/2016/12/13/bash_learn/#使用if" class="headerlink" title="使用if"></a>使用<code>if</code></h2><p><code>if</code>在使用上跟其它语言相同。如果中括号里的表达式为真，那么<code>then</code>和<code>fi</code>之间的代码会被执行。<code>fi</code>标志着条件代码块的结束。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 写成一行</span></span><br><span class="line"><span class="keyword">if</span> [[ 1 -eq 1 ]]; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">"true"</span>; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写成多行</span></span><br><span class="line"><span class="keyword">if</span> [[ 1 -eq 1 ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"true"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>同样，我们可以使用<code>if..else</code>语句，例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 写成一行</span></span><br><span class="line"><span class="keyword">if</span> [[ 2 -ne 1 ]]; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">"true"</span>; <span class="keyword">else</span> <span class="built_in">echo</span> <span class="string">"false"</span>; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写成多行</span></span><br><span class="line"><span class="keyword">if</span> [[ 2 -ne 1 ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>有些时候，<code>if..else</code>不能满足我们的要求。别忘了<code>if..elif..else</code>，使用起来也很方便。</p>
<p>看下面的例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ `uname` == <span class="string">"Adam"</span> ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Do not eat an apple!"</span></span><br><span class="line"><span class="keyword">elif</span> [[ `uname` == <span class="string">"Eva"</span> ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Do not take an apple!"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Apples are delicious!"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="使用case"><a href="/2016/12/13/bash_learn/#使用case" class="headerlink" title="使用case"></a>使用<code>case</code></h2><p>如果你需要面对很多情况，分别要采取不同的措施，那么使用<code>case</code>会比嵌套的<code>if</code>更有用。使用<code>case</code>来解决复杂的条件判断，看起来像下面这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$extension</span>"</span> <span class="keyword">in</span></span><br><span class="line">  <span class="string">"jpg"</span>|<span class="string">"jpeg"</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"It's image with jpeg extension."</span></span><br><span class="line">  ;;</span><br><span class="line">  <span class="string">"png"</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"It's image with png extension."</span></span><br><span class="line">  ;;</span><br><span class="line">  <span class="string">"gif"</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Oh, it's a giphy!"</span></span><br><span class="line">  ;;</span><br><span class="line">  *)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Woops! It's not image!"</span></span><br><span class="line">  ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line">`sh中的循环也是只要控制条件为真就一直迭代执行的代码块。</span><br><span class="line"></span><br><span class="line">Bash中有四种循环：`<span class="keyword">for</span>`，`<span class="keyword">while</span>`，`until`和`select`。</span><br><span class="line"></span><br><span class="line"><span class="comment">## `for`循环</span></span><br><span class="line"></span><br><span class="line">`<span class="keyword">for</span>`与它在C语言中的姊妹非常像。看起来是这样：</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> elem1 elem2 ... elemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="comment"># 语句</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>在每次循环的过程中，<code>arg</code>依次被赋值为从<code>elem1</code>到<code>elemN</code>。这些值还可以是通配符或者<a href="/2016/12/13/bash_learn/#大括号扩展">大括号扩展</a>。</p>
<p>当然，我们还可以把<code>for</code>循环写在一行，但这要求<code>do</code>之前要有一个分号，就像下面这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>还有，如果你觉得<code>for..in..do</code>对你来说有点奇怪，那么你也可以像C语言那样使用<code>for</code>，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 10; i++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>当我们想对一个目录下的所有文件做同样的操作时，<code>for</code>就很方便了。举个例子，如果我们想把所有的<code>.bash</code>文件移动到<code>script</code>文件夹中，并给它们可执行权限，我们的脚本可以这样写：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> FILE <span class="keyword">in</span> <span class="variable">$HOME</span>/*.bash; <span class="keyword">do</span></span><br><span class="line">  mv <span class="string">"<span class="variable">$FILE</span>"</span> <span class="string">"<span class="variable">$&#123;HOME&#125;</span>/scripts"</span></span><br><span class="line">  chmod +x <span class="string">"<span class="variable">$&#123;HOME&#125;</span>/scripts/<span class="variable">$&#123;FILE&#125;</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="while循环"><a href="/2016/12/13/bash_learn/#while循环" class="headerlink" title="while循环"></a><code>while</code>循环</h2><p><code>while</code>循环检测一个条件，只要这个条件为 _真_，就执行一段命令。被检测的条件跟<code>if..then</code>中使用的<a href="/2016/12/13/bash_learn/#基元和组合表达式">基元</a>并无二异。因此一个<code>while</code>循环看起来会是这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [[ condition ]]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="comment"># 语句</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>跟<code>for</code>循环一样，如果我们把<code>do</code>和被检测的条件写到一行，那么必须要在<code>do</code>之前加一个分号。</p>
<p>比如下面这个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0到9之间每个数的平方</span></span><br><span class="line">x=0</span><br><span class="line"><span class="keyword">while</span> [[ <span class="variable">$x</span> -lt 10 ]]; <span class="keyword">do</span> <span class="comment"># x小于10</span></span><br><span class="line">  <span class="built_in">echo</span> $(( x * x ))</span><br><span class="line">  x=$(( x + 1 )) <span class="comment"># x加1</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="until循环"><a href="/2016/12/13/bash_learn/#until循环" class="headerlink" title="until循环"></a><code>until</code>循环</h2><p><code>until</code>循环跟<code>while</code>循环正好相反。它跟<code>while</code>一样也需要检测一个测试条件，但不同的是，只要该条件为 _假_ 就一直执行循环：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">until [[ condition ]]; <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># 语句</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="select循环"><a href="/2016/12/13/bash_learn/#select循环" class="headerlink" title="select循环"></a><code>select</code>循环</h2><p><code>select</code>循环帮助我们组织一个用户菜单。它的语法几乎跟<code>for</code>循环一致：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select answer <span class="keyword">in</span> elem1 elem2 ... elemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="comment"># 语句</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p><code>select</code>会打印<code>elem1..elemN</code>以及它们的序列号到屏幕上，之后会提示用户输入。通常看到的是<code>$?</code>（<code>PS3</code>变量）。用户的选择结果会被保存到<code>answer</code>中。如果<code>answer</code>是一个在<code>1..N</code>之间的数字，那么<code>语句</code>会被执行，紧接着会进行下一次迭代 —— 如果不想这样的话我们可以使用<code>break</code>语句。</p>
<p>一个可能的实例可能会是这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PS3=<span class="string">"Choose the package manager: "</span></span><br><span class="line">select ITEM <span class="keyword">in</span> bower npm gem pip</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> -n <span class="string">"Enter the package name: "</span> &amp;&amp; <span class="built_in">read</span> PACKAGE</span><br><span class="line">  <span class="keyword">case</span> <span class="variable">$ITEM</span> <span class="keyword">in</span></span><br><span class="line">    bower) bower install <span class="variable">$PACKAGE</span> ;;</span><br><span class="line">    npm)   npm   install <span class="variable">$PACKAGE</span> ;;</span><br><span class="line">    gem)   gem   install <span class="variable">$PACKAGE</span> ;;</span><br><span class="line">    pip)   pip   install <span class="variable">$PACKAGE</span> ;;</span><br><span class="line">  <span class="keyword">esac</span></span><br><span class="line">  <span class="built_in">break</span> <span class="comment"># 避免无限循环</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>这个例子，先询问用户他想使用什么包管理器。接着，又询问了想安装什么包，最后执行安装操作。</p>
<p>运行这个脚本，会得到如下输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ./my_script</span><br><span class="line">1) bower</span><br><span class="line">2) npm</span><br><span class="line">3) gem</span><br><span class="line">4) pip</span><br><span class="line">Choose the package manager: 2</span><br><span class="line">Enter the package name: bash-handbook</span><br><span class="line">&lt;installing bash-handbook&gt;</span><br></pre></td></tr></table></figure>
<h2 id="循环控制"><a href="/2016/12/13/bash_learn/#循环控制" class="headerlink" title="循环控制"></a>循环控制</h2><p>我们会遇到想提前结束一个循环或跳过某次循环执行的情况。这些可以使用shell内建的<code>break</code>和<code>continue</code>语句来实现。它们可以在任何循环中使用。</p>
<p><code>break</code>语句用来提前结束当前循环。我们之前已经见过它了。</p>
<p><code>continue</code>语句用来跳过某次迭代。我们可以这么来用它：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 10; i++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">if</span> [[ $(( i % 2 )) -eq 0 ]]; <span class="keyword">then</span> <span class="built_in">continue</span>; <span class="keyword">fi</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>运行上面的例子，会打印出所有0到9之间的奇数。</p>
<h1 id="函数"><a href="/2016/12/13/bash_learn/#函数" class="headerlink" title="函数"></a>函数</h1><p>在脚本中，我们可以定义并调用函数。跟其它程序设计语言类似，函数是一个代码块，但有所不同。</p>
<p>bash中，函数是一个命令序列，这个命令序列组织在某个名字下面，即 <em>函数名</em> 。调用函数跟其它语言一样，写下函数名字，函数就会被 _调用_ 。</p>
<p>我们可以这样声明函数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">my_func</span></span> () &#123;</span><br><span class="line">  <span class="comment"># 语句</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">my_func <span class="comment"># 调用 my_func</span></span><br></pre></td></tr></table></figure>
<p>我们必须在调用前声明函数。</p>
<p>函数可以接收参数并返回结果 —— 返回值。参数，在函数内部，跟<a href="/2016/12/13/bash_learn/#非交互模式">非交互式</a>下的脚本参数处理方式相同 —— 使用<a href="/2016/12/13/bash_learn/#位置参数">位置参数</a>。返回值可以使用<code>return</code>命令 _返回_ 。</p>
<p>下面这个函数接收一个名字参数，返回<code>0</code>，表示成功执行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 带参数的函数</span></span><br><span class="line"><span class="function"><span class="title">greeting</span></span> () &#123;</span><br><span class="line">  <span class="keyword">if</span> [[ -n <span class="variable">$1</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Hello, <span class="variable">$1</span>!"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Hello, unknown!"</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greeting Denys  <span class="comment"># Hello, Denys!</span></span><br><span class="line">greeting        <span class="comment"># Hello, unknown!</span></span><br></pre></td></tr></table></figure>
<p>我们之前已经介绍过<a href="/2016/12/13/bash_learn/#返回值">返回值</a>。不带任何参数的<code>return</code>会返回最后一个执行的命令的返回值。上面的例子，<code>return 0</code>会返回一个成功表示执行的值，<code>0</code>。</p>
<h2 id="Debugging"><a href="/2016/12/13/bash_learn/#Debugging" class="headerlink" title="Debugging"></a>Debugging</h2><p>shell提供了用于debugging脚本的工具。如果我们想以debug模式运行某脚本，可以在其shebang中使用一个特殊的选项：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash options</span></span><br></pre></td></tr></table></figure>
<p>options是一些可以改变shell行为的选项。下表是一些可能对你有用的选项：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Short</th>
<th style="text-align:left">Name</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>-f</code></td>
<td style="text-align:left">noglob</td>
<td style="text-align:left">禁止文件名展开（globbing）</td>
</tr>
<tr>
<td style="text-align:center"><code>-i</code></td>
<td style="text-align:left">interactive</td>
<td style="text-align:left">让脚本以 _交互_ 模式运行</td>
</tr>
<tr>
<td style="text-align:center"><code>-n</code></td>
<td style="text-align:left">noexec</td>
<td style="text-align:left">读取命令，但不执行（语法检查）</td>
</tr>
<tr>
<td style="text-align:center"><code>-t</code></td>
<td style="text-align:left">—</td>
<td style="text-align:left">执行完第一条命令后退出</td>
</tr>
<tr>
<td style="text-align:center"><code>-v</code></td>
<td style="text-align:left">verbose</td>
<td style="text-align:left">在执行每条命令前，向<code>stderr</code>输出该命令</td>
</tr>
<tr>
<td style="text-align:center"><code>-x</code></td>
<td style="text-align:left">xtrace</td>
<td style="text-align:left">在执行每条命令前，向<code>stderr</code>输出该命令以及该命令的扩展参数</td>
</tr>
</tbody>
</table>
<p>举个例子，如果我们在脚本中指定了<code>-x</code>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash -x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 3; i++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>这会向<code>stdout</code>打印出变量的值和一些其它有用的信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ ./my_script</span><br><span class="line">+ (( i = 0 ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br><span class="line">+ echo 0</span><br><span class="line">0</span><br><span class="line">+ (( i++  ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br><span class="line">+ echo 1</span><br><span class="line">1</span><br><span class="line">+ (( i++  ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br><span class="line">+ echo 2</span><br><span class="line">2</span><br><span class="line">+ (( i++  ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br></pre></td></tr></table></figure>
<p>有时我们需要debug脚本的一部分。这种情况下，使用<code>set</code>命令会很方便。这个命令可以启用或禁用选项。使用<code>-</code>启用选项，<code>+</code>禁用选项：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"xtrace is turned off"</span></span><br><span class="line"><span class="built_in">set</span> -x</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"xtrace is enabled"</span></span><br><span class="line"><span class="built_in">set</span> +x</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"xtrace is turned off again"</span></span><br></pre></td></tr></table></figure>
<h2 id="更多资料"><a href="/2016/12/13/bash_learn/#更多资料" class="headerlink" title="更多资料"></a>更多资料</h2><ul>
<li>Bash的man页面。在Bash可以运行的众多环境中，通过运行<code>man bash</code>可以借助帮助系统<code>man</code>来显示Bash的帮助信息。</li>
<li><a href="https://www.gnu.org/software/bash/manual/" target="_blank" rel="noopener">“Bourne-Again SHell manual”</a><br><code></code></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/21/vba_base/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/21/vba_base/" itemprop="url">
                  收集一些vba的脚本
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-10-21 16:44:02" itemprop="dateCreated datePublished" datetime="2016-10-21T16:44:02+08:00">2016-10-21</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="分离工作簿"><a href="/2016/10/21/vba_base/#分离工作簿" class="headerlink" title="分离工作簿"></a>分离工作簿</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Sub SaveWorkSheetToBook()</span><br><span class="line">    Dim mbook As Workbook</span><br><span class="line">    Set mbook = ActiveWorkbook</span><br><span class="line">    Dim path As String</span><br><span class="line">    path = mbook.FullName</span><br><span class="line">    MsgBox path</span><br><span class="line">    </span><br><span class="line">    Dim pos%</span><br><span class="line">    pos = InStrRev(path, &quot;\&quot;)</span><br><span class="line">    path = Left(path, pos)</span><br><span class="line">    MsgBox path</span><br><span class="line">    </span><br><span class="line">    Dim i%</span><br><span class="line">    For i = 1 To mbook.Worksheets.Count</span><br><span class="line">        &apos; MsgBox mbook.Worksheets(i).Name</span><br><span class="line">        mbook.Worksheets(i).Copy</span><br><span class="line">        ActiveWorkbook.SaveAs Filename:=path &amp; mbook.Worksheets(i).Name &amp; &quot;.xlsx&quot;</span><br><span class="line">        ActiveWindow.Close</span><br><span class="line">    Next i</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/23/c_base/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DaSea">
      <meta itemprop="description" content="Fucking Code!">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="兼容">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/23/c_base/" itemprop="url">
                  原码,反码,补码, 大小端
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-09-23 17:52:18" itemprop="dateCreated datePublished" datetime="2016-09-23T17:52:18+08:00">2016-09-23</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原码-反码-补码-详解"><a href="/2016/09/23/c_base/#原码-反码-补码-详解" class="headerlink" title="原码, 反码, 补码 详解"></a>原码, 反码, 补码 详解</h2><h3 id="机器数与真值"><a href="/2016/09/23/c_base/#机器数与真值" class="headerlink" title="机器数与真值"></a>机器数与真值</h3><ol>
<li><p>机器数</p>
<ul>
<li>一个数在计算机中的二进制表示形式, 叫做这个数的机器数;</li>
<li>机器数是带符号的, 使用最高位为符号位, 正数为0, 负数为1;</li>
<li>如: +3:0000 0011; -3:1000 0011; 这里的二进制就是机器数;</li>
</ul>
</li>
<li><p>真值</p>
<ul>
<li>因为第一位为符号位, 所以机器数的形式值就不等于真正的数值;</li>
<li>如:1000 0011, 其最高位1代表负, 其真正数值是-3而不是形式值131;</li>
<li>将符号位的机器数对应的真正的数值称为机器数的真值;</li>
<li>如: 0000 0001的真值是: +1; 1000 0001的真值是: -1;</li>
</ul>
</li>
</ol>
<p>==原码, 反码, 补码的基础概念和计算方法==</p>
<ol>
<li><p>原码</p>
<ul>
<li>原码就是符号位加上真值的绝对值</li>
<li>第一位为符号位,所以8位二进制的范围为: [1111 111, 0111 111]; [-127, 127]</li>
<li>上面的范围缺-128? 后面解释.</li>
<li>最符合人脑的方式;</li>
</ul>
</li>
<li><p>反码</p>
<ul>
<li>正数的反码是其本身;</li>
<li><p>负数的反码是在其反码的基础上, 符号位不变, 其余位取反:如</p>
<ul>
<li>[+1] = [0000 0001]原 = [0000 0001]反</li>
<li>[-1] = [1000 0001]原 = [1111 1110]反</li>
</ul>
</li>
<li><p>如果一个反码表示负数, 人脑无法直接观看;</p>
</li>
</ul>
</li>
<li><p>补码</p>
<ul>
<li>正数的补码是其本身;</li>
<li><p>负数是其反码+1, 如下:</p>
<ul>
<li>[+1] = [0000 0001]原 = [0000 0001]反 = [0000 0001]补</li>
<li><p>[-1] = [1000 0001]原 = [1111 1110]反 = [1111 1111]补</p>
<h3 id="使用原码-反码-补码的原因"><a href="/2016/09/23/c_base/#使用原码-反码-补码的原因" class="headerlink" title="使用原码,反码,补码的原因"></a>使用原码,反码,补码的原因</h3></li>
</ul>
</li>
</ul>
</li>
<li><p>对于正数都是一样的,所以忽略;</p>
</li>
<li><p>对于负数,不同, 为什么会存在呢?</p>
<ul>
<li>对于人脑, 可以知道第一位是符号位, 在计算的时候会根据符号位,选择对真值区域的加减;</li>
<li>对于计算机,加减乘除已经是最基础的运算, 要设计的尽量简单, 计算机辨别”符号位”显然会让基础电路 变的复杂, 于是人们开始考虑让符号位也参与运算的方法;</li>
<li>根据运算规则, 1-1 = 1 + (-1) = 0; 如果机器只有加法没有减法, 计算机运算的设计就更简单了;</li>
<li><p>人们继续探索将符号位参与运算, 并且只保留加法的方法:</p>
<ul>
<li>1 - 1 = 1 + (-1) = [0000 0001]原 + [1000 0001]原 = [1000 0010]原 = -2 如果用原码表示,让符号位参与运算, 显然对于减法来说, 结果不正确, 这也就是计算机中不使用 原码表示一个数, 为了解决原码做减法的问题, 出现了反码;</li>
<li>1 - 1 = 1 + (-1) = [0000 0001]反 + [1111 1110]反 = [1111 1111]反 = [1000 0000]原 = -0 发现使用反码计算减法, 结果的真值部分是正确的, 但是确出现了-0, 而且-0是没有用, 并且会有 [0000 0000]原 和 [1000 0000]原 俩个编码表示0; 于是出现了补码, 解决了0的符号问题, 以及俩个编码的问题,</li>
<li>1-1 = 1 + (-1) = [0000 0001]补+[1111 1111]补 = [0000 0000]补 = 0 (-1)+(-127) = [1111 1111]补 + [1000 0001]补 = [1000 0000]补 = -128; -1-127的结果是-128, 在用补码运算的结果中, [1000 0000]补 就是-128, 实际就是-0的补码, 所以-128并没有原码和反码表示.</li>
</ul>
</li>
<li><p>使用补码, 不仅仅修复了0的符号以及存在俩个编码的问题, 而且还能够多表示一个最低数, 这就是为什么8位二进制, 使用原码或反码表示的范围是[-127, 127], 而使用补码表示的范围是[-128, 127];</p>
</li>
<li>机器使用补码, 所以对于编程中常用到的32位int类型, 可以表示范围: [-2^31, 2^31 -1], 因为第一位表示符号位,使用补码表示时可以多保存一个最小值;</li>
</ul>
</li>
</ol>
<h3 id="原码-反码-补码-再深入"><a href="/2016/09/23/c_base/#原码-反码-补码-再深入" class="headerlink" title="原码,反码, 补码 再深入"></a>原码,反码, 补码 再深入</h3><pre><code>参考网址:博客园已转载
</code></pre><h2 id="大端小端"><a href="/2016/09/23/c_base/#大端小端" class="headerlink" title="大端小端"></a>大端小端</h2><ul>
<li>小端: 低位字节存放在内存的低地址端, 高位字节存放在内存的高地址端;</li>
<li>大端: 高位字节存放在内存的低地址端, 低位字节存放在内存的低地址端;</li>
<li>网络字节序: 大端模式;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">如:</span><br><span class="line">十进制: 10 000</span><br><span class="line">二进制: 100111 00010000</span><br><span class="line">十六进制: 0x27 0x10</span><br><span class="line"></span><br><span class="line">大端机制存储:</span><br><span class="line">00100111 00010000</span><br><span class="line">0x27 0x10</span><br><span class="line">小端机制存储:</span><br><span class="line">00010000 001000111</span><br><span class="line">0x10 0x27</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 算法</span></span><br><span class="line"><span class="keyword">union</span> &#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> b;</span><br><span class="line">&#125;c;</span><br><span class="line">c.a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1</span> == c.b) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"小端序"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"大端序"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">DaSea</p>
              <p class="site-description motion-element" itemprop="description">Fucking Code!</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">51</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">25</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/DaSea" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DaSea</span>

  

  
</div>


  



  <div class="powered-by">Powered by <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://theme-next.org">NexT.Gemini</a> v6.3.0</div>




        








        
      </div>
    </footer>

    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
